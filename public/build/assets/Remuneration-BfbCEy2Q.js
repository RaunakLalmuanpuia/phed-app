import{Q as ae,a as $}from"./QBreadcrumbs-DHMbpWdL.js";import{Q as A}from"./QSelect-BUH9Uw-P.js";import{r as i,x as le,c as T,o as B,w as l,b as n,f as a,e as G,p as U,q as w,u as v,l as ne,m as N,B as h,t as u,Q as E,z as F,a0 as oe,$ as se,N as ie}from"./app-BWCDUq_V.js";import{Q as V}from"./QTd-CkbSLyQV.js";import{Q as re}from"./QTable-DtUMnBSX.js";import{Q as ue}from"./QLayout-DEkhdx-g.js";import{_ as de,C as me}from"./BackendLayout-DSRLMv7f.js";import{u as ce}from"./use-quasar-BF5iGRlS.js";import{u as fe}from"./useUtils-CSTnIEzD.js";import"./use-fullscreen-SFCi99CN.js";import"./touch-BKkyDwUZ.js";import"./date-DQ0npdhN.js";const pe={class:"flex items-center justify-between q-pa-md bg-white"},ve={class:"q-pa-md"},be={class:"row q-col-gutter-md"},ge={class:"row q-gutter-sm col-12 col-sm justify-end"},_e={class:"row q-mb-sm items-center"},ye={class:"col-8 text-body1"},xe={class:"row q-mb-sm items-center"},we={class:"col-8 text-body1"},Ve={class:"row q-mb-sm items-center"},Qe={class:"col-8 text-body1"},qe={class:"row q-mb-sm items-center"},Ce={class:"col-8 text-body1"},ke={class:"row q-mb-sm items-center"},Re={class:"col-8 text-body1"},z=2020,Ne=2035,$e=Object.assign({layout:de},{__name:"Remuneration",props:["office","canGenerateRemuneration"],setup(O){const{formatDate:Y}=fe(),d=i({offices:[],incrementYear:""}),L=Array.from({length:Ne-z+1},(s,e)=>z+e),D=i(""),Q=ce(),q=i([]),S=i(!1),b=i(!1),y=i(!1),I=i(!1),c=i(null);function M(){if(!d.value.offices||d.value.offices.length===0){Q.notify({type:"negative",message:"Please select an office"});return}if(!d.value.incrementYear){Q.notify({type:"negative",message:"Please enter the increment year"});return}I.value=!0,q.value=[],setTimeout(()=>{c.value&&c.value.requestServerInteraction()})}function H(){g.value.page=1,c.value&&c.value.requestServerInteraction()}function j(){q.value=[],I.value=!1}function J(s){(!s||s.length===0)&&j()}const r=le({remuneration:"",next_increment_date:""}),g=i({sortBy:"next_increment_date",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),K=[{name:"name",label:"Name",field:"name",align:"left",sortable:!0},{name:"designation",label:"Designation",field:"designation",align:"left",sortable:!0},{name:"office",label:"Office",field:"office.name",align:"left"},{name:"remuneration",label:"Remuneration",field:"remuneration_detail.remuneration",align:"right"},{name:"total",label:"Total",field:"remuneration_detail.round_total",align:"right"},{name:"next_increment_date",label:"Next Increment",field:"remuneration_detail.next_increment_date",align:"left"},{name:"actions",label:"Actions",align:"center"}],P=i(null),_=i(null),W=s=>{_.value=s,s.remuneration_detail?(r.remuneration=s.remuneration_detail.remuneration,r.next_increment_date=s.remuneration_detail.next_increment_date):r.reset(),P.value=s.id,y.value=!0,b.value=!1},X=()=>{b.value=!0},Z=()=>{b.value=!1,y.value=!1,r.reset()};function ee(s){const{page:e,rowsPerPage:t,sortBy:o,descending:C}=s.pagination;S.value=!0,axios.get(route("mis.json-remuneration"),{params:{filter:{...d.value},page:e,rowsPerPage:t,search:D.value,sortBy:o,descending:C}}).then(m=>{const{list:f}=m.data,{data:p,per_page:k,current_page:R,total:x}=f;q.value=p,g.value.page=R,g.value.rowsNumber=x,g.value.rowsPerPage=k}).catch(m=>{var f,p;Q.notify({type:"negative",message:(p=(f=m==null?void 0:m.response)==null?void 0:f.data)==null?void 0:p.message})}).finally(()=>S.value=!1)}const te=()=>{P.value&&r.put(route("remuneration.update",P.value),{onSuccess:()=>{y.value=!1,r.reset(),c.value&&c.value.requestServerInteraction(),Q.notify({type:"positive",message:"Remuneration updated successfully."})}})};return(s,e)=>(B(),T(ue,{class:"container",padding:""},{default:l(()=>[n("div",pe,[n("div",null,[e[8]||(e[8]=n("div",{class:"stitle"},"Remuneration List",-1)),a(ae,{class:"text-dark"},{default:l(()=>[a($,{onClick:e[0]||(e[0]=t=>s.$inertia.get(s.route("dashboard"))),icon:"dashboard",label:"Dashboard"}),a($,{label:"Remuneration",to:s.route("mis.import")},null,8,["to"])]),_:1})])]),e[16]||(e[16]=n("br",null,null,-1)),a(U,{flat:""},{default:l(()=>[a(w,null,{default:l(()=>[n("div",ve,[a(U,{flat:"",class:"q-mt-md bg-white shadow-1"},{default:l(()=>[a(w,null,{default:l(()=>[e[9]||(e[9]=n("div",{class:"text-subtitle1 text-weight-medium text-grey-8 q-mb-md"}," Office Filter ",-1)),n("div",be,[a(A,{label:"Select Office(s)",class:"col-12 col-sm-6",modelValue:d.value.offices,"onUpdate:modelValue":[e[1]||(e[1]=t=>d.value.offices=t),J],options:O.office,"option-label":"name","option-value":"id","emit-value":"","map-options":"",outlined:"",dense:"",clearable:"",onClear:j},null,8,["modelValue","options"]),a(A,{class:"col-12 col-sm-3",outlined:"",dense:"",clearable:"",label:"Increment Year",modelValue:d.value.incrementYear,"onUpdate:modelValue":e[2]||(e[2]=t=>d.value.incrementYear=t),options:v(L),"emit-value":"","map-options":""},null,8,["modelValue","options"])])]),_:1,__:[9]}),a(ne),a(w,{class:"row items-center justify-between q-gutter-md"},{default:l(()=>[n("div",ge,[O.canGenerateRemuneration?(B(),T(N,{key:0,label:"Get Employee",color:"primary",onClick:M})):G("",!0)])]),_:1})]),_:1})])]),_:1})]),_:1}),e[17]||(e[17]=n("br",null,null,-1)),I.value?(B(),T(re,{key:0,ref_key:"empTable",ref:c,title:"Employees",rows:q.value,columns:K,"row-key":"id",loading:S.value,pagination:g.value,"onUpdate:pagination":e[4]||(e[4]=t=>g.value=t),"rows-per-page-options":[5,10,20,50],onRequest:ee},{"top-right":l(()=>[a(E,{borderless:"",dense:"",debounce:"800","bg-color":"grey-2",outlined:"",modelValue:D.value,"onUpdate:modelValue":[e[3]||(e[3]=t=>D.value=t),H],placeholder:"Search",clearable:""},{append:l(()=>[a(F,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-office":l(t=>[a(V,{props:t},{default:l(()=>{var o;return[h(u((o=t.row.office)==null?void 0:o.name),1)]}),_:2},1032,["props"])]),"body-cell-remuneration":l(t=>[a(V,{props:t},{default:l(()=>{var o;return[h(u((o=t.row.remuneration_detail)==null?void 0:o.remuneration),1)]}),_:2},1032,["props"])]),"body-cell-total":l(t=>[a(V,{props:t},{default:l(()=>{var o;return[h(u((o=t.row.remuneration_detail)==null?void 0:o.round_total),1)]}),_:2},1032,["props"])]),"body-cell-next_increment_date":l(t=>[a(V,{props:t},{default:l(()=>{var o;return[h(u(v(Y)((o=t.row.remuneration_detail)==null?void 0:o.next_increment_date)),1)]}),_:2},1032,["props"])]),"body-cell-actions":l(t=>[a(V,{props:t},{default:l(()=>[a(N,{dense:"",flat:"",round:"",color:"primary",icon:"edit",onClick:o=>W(t.row),"aria-label":"Edit"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","pagination"])):G("",!0),a(oe,{modelValue:y.value,"onUpdate:modelValue":e[7]||(e[7]=t=>y.value=t)},{default:l(()=>[a(U,{style:{"min-width":"400px"}},{default:l(()=>[a(w,null,{default:l(()=>e[10]||(e[10]=[n("div",{class:"text-h6"},"Edit Remuneration",-1)])),_:1,__:[10]}),a(w,{class:"q-gutter-md"},{default:l(()=>{var t,o,C,m,f,p,k,R;return[n("div",_e,[e[11]||(e[11]=n("div",{class:"col-4 text-subtitle2 text-grey-8"},"Name",-1)),n("div",ye,u((t=_.value)==null?void 0:t.name),1)]),n("div",xe,[e[12]||(e[12]=n("div",{class:"col-4 text-subtitle2 text-grey-8"},"Designation",-1)),n("div",we,u((o=_.value)==null?void 0:o.designation),1)]),n("div",Ve,[e[13]||(e[13]=n("div",{class:"col-4 text-subtitle2 text-grey-8"},"Office",-1)),n("div",Qe,u((m=(C=_.value)==null?void 0:C.office)==null?void 0:m.name),1)]),n("div",qe,[e[14]||(e[14]=n("div",{class:"col-4 text-subtitle2 text-grey-8"},"Current Remuneration (Total)",-1)),n("div",Ce,"Rs "+u(((p=(f=_.value)==null?void 0:f.remuneration_detail)==null?void 0:p.remuneration)||0),1)]),n("div",ke,[e[15]||(e[15]=n("div",{class:"col-4 text-subtitle2 text-grey-8"},"Date of Next Increment",-1)),n("div",Re,u(v(Y)((R=(k=_.value)==null?void 0:k.remuneration_detail)==null?void 0:R.next_increment_date)||0),1)]),a(E,{label:"Remuneration",type:"number",modelValue:v(r).remuneration,"onUpdate:modelValue":e[5]||(e[5]=x=>v(r).remuneration=x),outlined:"",dense:"",readonly:!b.value},{append:l(()=>[a(F,{name:"edit",class:"cursor-pointer",onClick:X})]),_:1},8,["modelValue","readonly"]),a(E,{label:"Next Increment Date",type:"date",modelValue:v(r).next_increment_date,"onUpdate:modelValue":e[6]||(e[6]=x=>v(r).next_increment_date=x),outlined:"",dense:"",readonly:!b.value},null,8,["modelValue","readonly"])]}),_:1}),a(se,{align:"right"},{default:l(()=>[ie(a(N,{flat:"",label:"Cancel",onClick:Z},null,512),[[me]]),a(N,{color:"primary",label:"Update",disable:!b.value,onClick:te},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1,__:[16,17]}))}});export{$e as default};
