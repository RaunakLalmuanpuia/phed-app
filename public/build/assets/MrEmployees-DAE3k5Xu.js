import{Q as M,a as S}from"./QBreadcrumbs-DwKRIHoy.js";import{r as u,i as T,c as _,o as k,w as o,b as n,f as l,t as m,m as b,p as I,q,Q as E,z as h,l as L,B as z,u as B,v as F}from"./app-CWeOV7mW.js";import{Q as C}from"./QSelect-2Bq-iwOT.js";import{a as O,Q as W}from"./QLayout-JX5mO03v.js";import{Q}from"./QTd-WK8Ad-Ql.js";import{Q as G}from"./QTable-BgPZ23AO.js";import{_ as H}from"./BackendLayout-_LH758oD.js";import{u as J}from"./use-quasar-DSTf7FHt.js";import{u as K}from"./useUtils-DxxjrGZG.js";import"./touch-Dkm2Lbqu.js";import"./date-DeP6EFEO.js";const X={class:"flex items-center justify-between q-pa-md bg-white"},Y={class:"stitle"},Z={class:"q-gutter-sm"},ee={class:"row q-col-gutter-md"},ae={class:"row q-gutter-sm col-12 col-sm justify-end"},le={class:"flex items-center gap-3"},te={class:"text-body1"},oe={class:"text-caption text-grey"},se={class:"text-caption text-grey"},_e=Object.assign({layout:H},{__name:"MrEmployees",props:["office","skills","educationQln","canCreate","canEdit","canDelete"],setup(d){const{formatDate:V}=K(),v=d,$=[{name:"employee",label:"Employee",align:"left",field:"employee",sortable:!0},{name:"designation",label:"Designation",align:"left",field:"designation",sortable:!1},{name:"name_of_workplace",label:"Workplace",align:"left",field:"name_of_workplace",sortable:!1},{name:"skill_at_present",label:"Skill At Present",align:"left",field:"skill_at_present",sortable:!0},{name:"date_of_engagement",label:"Date of Engagement",align:"left",field:"date_of_engagement",sortable:!0},{name:"actions",label:"Actions",align:"center"}],s=u({search:null,skill:null,education_qln:null});u("");const c=J(),x=u([]),y=u(!1),i=u({sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),f=()=>{w({pagination:i.value,filter:s.value,search:s.value.search})};function w(t){const{page:a,rowsPerPage:e,sortBy:U,descending:ne}=t.pagination,R=t.filter,D=t.search;y.value=!0,axios.get(route("employees.json-index-mr",v.office),{params:{filter:R,page:a,rowsPerPage:e,search:D}}).then(r=>{console.log(r.data);const{list:p}=r.data,{data:g,per_page:j,current_page:A,total:N,to:ie,from:re}=p;x.value=g,i.value.page=A,i.value.rowsNumber=N,i.value.rowsPerPage=j}).catch(r=>{var p,g;c.notify({type:"negative",message:(g=(p=r==null?void 0:r.response)==null?void 0:p.data)==null?void 0:g.message})}).finally(()=>y.value=!1)}const P=()=>{c.loading.show(),axios.get(route("export.mr",v.office),{responseType:"blob"}).then(t=>{const a=window.URL.createObjectURL(new Blob([t.data])),e=document.createElement("a");e.href=a,e.setAttribute("download",v.office.name.replace(/\s+/g,"_")+"_muster_roll_employees.xlsx"),e.click()}).catch(t=>{var a,e;c.notify({type:"negative",message:((e=(a=t.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to download file"})}).finally(()=>{c.loading.hide()})};return T(()=>{w({pagination:i.value,filter:s.value,search:s.value.search})}),(t,a)=>(k(),_(W,{class:"container",padding:""},{default:o(()=>[n("div",X,[n("div",null,[n("div",Y,"Muster Roll Employee List: "+m(d.office.name),1),l(M,{class:"text-dark"},{default:o(()=>[l(S,{onClick:a[0]||(a[0]=e=>t.$inertia.get(t.route("dashboard"))),icon:"dashboard",label:"Dashboard"}),l(S,{label:"All Employees",to:t.route("mis.import")},null,8,["to"])]),_:1})]),n("div",Z,[l(b,{label:"MR Summary",color:"primary",onClick:a[1]||(a[1]=e=>t.$inertia.get(t.route("summary.mr")))})])]),a[9]||(a[9]=n("br",null,null,-1)),l(I,{flat:""},{default:o(()=>[l(q,null,{default:o(()=>[a[8]||(a[8]=n("div",{class:"text-subtitle1 text-weight-medium text-grey-8 q-mb-md"}," Search Filter ",-1)),n("div",ee,[l(E,{dense:"",outlined:"",debounce:"300",modelValue:s.value.search,"onUpdate:modelValue":[a[2]||(a[2]=e=>s.value.search=e),f],placeholder:"Search",class:"col-12 col-sm-4",clearable:""},{append:o(()=>[l(h,{name:"search"})]),_:1},8,["modelValue"]),l(C,{label:"Select Present Skill",class:"col-12 col-sm-4",modelValue:s.value.skill,"onUpdate:modelValue":[a[3]||(a[3]=e=>s.value.skill=e),f],options:d.skills,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"]),l(C,{label:"Select Education Qln.",class:"col-12 col-sm-4",modelValue:s.value.education_qln,"onUpdate:modelValue":[a[4]||(a[4]=e=>s.value.education_qln=e),f],options:d.educationQln,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])])]),_:1,__:[8]}),l(L),l(q,{class:"row items-center justify-between q-gutter-md"},{default:o(()=>[n("div",ae,[l(E,{dense:"",outlined:"",debounce:"300",modelValue:s.value.search,"onUpdate:modelValue":[a[5]||(a[5]=e=>s.value.search=e),f],placeholder:"Search",class:"col-12 col-sm-auto",clearable:""},{append:o(()=>[l(h,{name:"search"})]),_:1},8,["modelValue"]),l(b,{label:"Export",icon:"desktop_windows",color:"primary",onClick:P}),l(b,{label:"Add New MR Employee",icon:"add",color:"primary",onClick:a[6]||(a[6]=e=>t.$inertia.get(t.route("employee.create")))})])]),_:1}),l(G,{flat:"",ref:"tableRef",title:d.office.name,rows:x.value,columns:$,"row-key":"id",pagination:i.value,"onUpdate:pagination":a[7]||(a[7]=e=>i.value=e),loading:y.value,filter:s.value,"binary-state-sort":"","rows-per-page-options":[1,7,15,30,50],onRequest:w},{"body-cell-employee":o(e=>[l(Q,{props:e},{default:o(()=>[n("div",le,[l(F,null,{default:o(()=>[e.row.avatar?(k(),_(O,{key:0,src:`/storage/${e.row.avatar}`},null,8,["src"])):(k(),_(h,{key:1,name:"person",size:"md",color:"primary"}))]),_:2},1024),n("div",null,[n("div",te,m(e.row.name),1),n("div",oe,m(e.row.mobile),1),n("div",se,m(B(V)(e.row.date_of_birth)),1)])])]),_:2},1032,["props"])]),"body-cell-date_of_engagement":o(e=>[l(Q,{props:e},{default:o(()=>[z(m(B(V)(e.row.date_of_engagement)),1)]),_:2},1032,["props"])]),"body-cell-actions":o(e=>[l(Q,{props:e},{default:o(()=>[l(b,{dense:"",flat:"",round:"",color:"primary",icon:"visibility",onClick:U=>t.$inertia.get(t.route("employee.show",e.row.id)),"aria-label":"Show user"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["title","rows","pagination","loading","filter"])]),_:1})]),_:1,__:[9]}))}});export{_e as default};
