import{Q as Y}from"./QChip-CZ0n9mQ8.js";import{Q as O,a as D}from"./QBreadcrumbs-CjQB72kF.js";import{Q as V}from"./QSelect-VC1b8VuD.js";import{r as p,l as I,d as y,o as d,w as o,g as s,i as t,h as v,e as Q,F as z,v as M,y as R,z as x,u as G,q,t as c,A as H,D as E,Q as J}from"./app-E2q6TpZQ.js";import{a as K,Q as W}from"./QLayout-2p5ph-hK.js";import{Q as m}from"./QTd-DyxJdioY.js";import{Q as X}from"./QTable-RLkykN7x.js";import{_ as Z}from"./BackendLayout-Cgcv86pp.js";import{u as ee}from"./use-quasar-CNbaCbb_.js";import"./format-Bl2yNtZf.js";import"./QMarkupTable-BG3F4_f-.js";import"./use-fullscreen-9MTSoC1m.js";import"./touch-C3Yxwow6.js";import"./QSlideTransition-BKoCmltV.js";const ae={class:"flex items-center justify-between q-pa-md bg-white"},te={class:"stitle"},oe={class:"q-pa-md"},le={class:"row q-col-gutter-md"},se={class:"row q-gutter-sm col-12 col-sm justify-end"},ne={class:"flex items-center gap-3"},re={class:"text-body1"},ie={class:"text-caption text-grey"},de={class:"text-caption text-grey"},ue={key:0},ce={key:1},C=2020,me=2040,Ee=Object.assign({layout:Z},{__name:"DeletedEmployees",props:["offices"],setup(S){const P=[{name:"employee",label:"Employee",align:"left",field:"employee",sortable:!0},{name:"type",label:"Employment Type",align:"left",field:"type",sortable:!0},{name:"designation",label:"Designation",align:"left",field:"designation",sortable:!0},{name:"reason",label:"Reason",align:"left",field:"reason",sortable:!1},{name:"year",label:"Year",align:"left",field:"year",sortable:!1},{name:"supporting_document",label:"Document",align:"center",field:"supporting_document",sortable:!1},{name:"actions",label:"Actions",align:"center"}],n=p({year:new Date().getFullYear(),reason:null}),U=Array.from({length:me-C+1},(l,a)=>C+a),_=p(""),f=ee(),B=p([]),w=p(!1),i=p({sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),h=()=>{n.value.search=_.value,k({pagination:i.value,filter:n.value,search:n.value.search})};function k(l){const{page:a,rowsPerPage:e,sortBy:r,descending:pe}=l.pagination,A=l.filter,N=l.search;w.value=!0,axios.get(route("employees.json-manager-deleted"),{params:{filter:A,page:a,rowsPerPage:e,search:N}}).then(u=>{console.log(u.data);const{list:g}=u.data,{data:b,per_page:F,current_page:L,total:T,to:fe,from:ge}=g;B.value=b,i.value.page=L,i.value.rowsNumber=T,i.value.rowsPerPage=F}).catch(u=>{var g,b;f.notify({type:"negative",message:(b=(g=u==null?void 0:u.response)==null?void 0:g.data)==null?void 0:b.message})}).finally(()=>w.value=!1)}I(()=>{k({pagination:i.value,filter:n.value,search:n.value.search})});const $=()=>{window.history.back()},j=()=>{f.loading.show(),axios.get(route("export.deleted"),{responseType:"blob"}).then(l=>{const a=window.URL.createObjectURL(new Blob([l.data])),e=document.createElement("a");e.href=a,e.setAttribute("download",Date.now()+".xlsx"),e.click()}).catch(l=>{var a,e;f.notify({type:"negative",message:((e=(a=l.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to download file"})}).finally(()=>{f.loading.hide()})};return(l,a)=>(d(),y(W,{class:"container",padding:""},{default:o(()=>[s("div",ae,[s("div",null,[s("div",te,[a[5]||(a[5]=v("Deleted Employee List : ")),(d(!0),Q(z,null,M(S.offices,e=>(d(),y(Y,{square:"",key:e.value,label:e.label},null,8,["label"]))),128))]),t(O,{class:"text-dark"},{default:o(()=>[t(D,{class:"cursor-pointer",onClick:a[0]||(a[0]=e=>l.$inertia.get(l.route("dashboard"))),icon:"dashboard",label:"Dashboard"}),t(D,{class:"cursor-pointer",label:"Go Back",onClick:$})]),_:1})])]),a[7]||(a[7]=s("br",null,null,-1)),t(R,{flat:""},{default:o(()=>[t(x,null,{default:o(()=>[s("div",oe,[t(R,{flat:"",bordered:"",class:"q-mt-md bg-white shadow-1"},{default:o(()=>[t(x,null,{default:o(()=>[a[6]||(a[6]=s("div",{class:"text-subtitle1 text-weight-medium text-grey-8 q-mb-md"}," Search Filter ",-1)),s("div",le,[t(V,{dense:"",outlined:"",debounce:"300",modelValue:n.value.reason,"onUpdate:modelValue":[a[1]||(a[1]=e=>n.value.reason=e),h],options:["Expired","Resigned","Dismissed","Regularised","Others (Specify the reasons to Remarks)"],label:"Select Reason",class:"col-12 col-sm-4","emit-value":"","map-options":"",clearable:""},null,8,["modelValue"]),t(V,{class:"col-12 col-sm-4",outlined:"",dense:"",clearable:"",label:"Year",modelValue:n.value.year,"onUpdate:modelValue":[a[2]||(a[2]=e=>n.value.year=e),h],options:G(U),"emit-value":"","map-options":""},null,8,["modelValue","options"])])]),_:1,__:[6]})]),_:1})])]),_:1}),t(x,{class:"row items-center justify-between q-gutter-md"},{default:o(()=>[s("div",se,[t(q,{label:"Export",icon:"desktop_windows",color:"primary",onClick:j})])]),_:1}),t(X,{flat:"",ref:"tableRef",title:"List of Deleted Employees",rows:B.value,columns:P,"row-key":"id",pagination:i.value,"onUpdate:pagination":a[4]||(a[4]=e=>i.value=e),loading:w.value,filter:n.value,"binary-state-sort":"","rows-per-page-options":[1,7,15,30,50],onRequest:k},{"top-right":o(()=>[t(J,{dense:"",outlined:"",debounce:"800",modelValue:_.value,"onUpdate:modelValue":[a[3]||(a[3]=e=>_.value=e),h],placeholder:"Search",class:"col-12 col-sm-auto",clearable:""},{append:o(()=>[t(E,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-employee":o(e=>[t(m,{props:e},{default:o(()=>[s("div",ne,[t(H,null,{default:o(()=>[e.row.avatar?(d(),y(K,{key:0,src:`/storage/${e.row.avatar}`},null,8,["src"])):(d(),y(E,{key:1,name:"person",size:"md",color:"primary"}))]),_:2},1024),s("div",null,[s("div",re,c(e.row.name),1),s("div",ie,c(e.row.mobile),1),s("div",de,c(e.row.date_of_birth),1)])])]),_:2},1032,["props"])]),"body-cell-type":o(e=>[t(m,{props:e},{default:o(()=>[v(c(e.row.designation?"Provisional":"Muster Roll"),1)]),_:2},1032,["props"])]),"body-cell-reason":o(e=>[t(m,{props:e},{default:o(()=>{var r;return[v(c((r=e.row.deletion_detail)==null?void 0:r.reason),1)]}),_:2},1032,["props"])]),"body-cell-year":o(e=>[t(m,{props:e},{default:o(()=>{var r;return[v(c((r=e.row.deletion_detail)==null?void 0:r.year),1)]}),_:2},1032,["props"])]),"body-cell-supporting_document":o(e=>[t(m,{props:e},{default:o(()=>{var r;return[(r=e.row.deletion_detail)!=null&&r.supporting_document?(d(),Q("span",ue,[t(q,{dense:"",flat:"",round:"",color:"primary",icon:"attachment",href:`/storage/${e.row.deletion_detail.supporting_document}`,target:"_blank"},null,8,["href"])])):(d(),Q("span",ce,"N/A"))]}),_:2},1032,["props"])]),"body-cell-actions":o(e=>[t(m,{props:e},{default:o(()=>[t(q,{dense:"",flat:"",round:"",color:"primary",icon:"visibility",onClick:r=>l.$inertia.get(l.route("employee.show",e.row.id)),"aria-label":"Show user"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","pagination","loading","filter"])]),_:1})]),_:1,__:[7]}))}});export{Ee as default};
