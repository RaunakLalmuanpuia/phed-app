import{Q as F,a as P}from"./QBreadcrumbs-NgyEKFLJ.js";import{r as y,l as L,d,o as i,w as n,e as a,i as o,t as p,q as v,y as x,z as V,f as I,F as O,v as G,A as B,B as H,D as q,g as b,p as J,Q as K,h as X,u as Y}from"./app-DGXfuPPQ.js";import{Q as g,a as Z}from"./QSelect-C6vLXduZ.js";import{a as ee,Q as le}from"./QLayout-DG8bxe8I.js";import{Q as E}from"./QTd-TDpcFZfN.js";import{Q as oe}from"./QTable-ChBgW3x2.js";import{_ as te}from"./BackendLayout-CjRXICMe.js";import{u as ae}from"./use-quasar-88dqkiD3.js";import{u as se}from"./useUtils-CpeghwuA.js";import"./format-DktOhZJm.js";import"./QMarkupTable-BlSccUe2.js";import"./use-fullscreen-YXi8GqE8.js";import"./touch-XCyy1_Fh.js";import"./QSlideTransition-BCON992K.js";import"./date-CVWqZY61.js";const ne={class:"flex items-center justify-between q-pa-md bg-white"},ie={class:"stitle"},re={class:"q-gutter-sm"},de={class:"q-pa-md"},ue={class:"q-gutter-md row q-col-gutter-md"},me={class:"row justify-between items-center"},ce={class:"text-grey-6 text-subtitle1"},pe={class:"text-h5 text-weight-bold"},fe={class:"row q-col-gutter-md"},ge={class:"row q-gutter-sm col-12 col-sm justify-end"},ye={class:"flex items-center gap-3"},ve={class:"text-body1"},be={class:"text-caption text-grey"},we={class:"text-caption text-grey"},je=Object.assign({layout:te},{__name:"AllEmployees",props:["office","totalEmployees","wcCount","peCount","mrCount","deletedCount","designationsWc","designationsPe","skills","educationQlnPe","educationQlnMr"],setup(r){const{formatDate:U}=se(),u=r,$=[{name:"employee",label:"Employee",align:"left",field:"employee",sortable:!0},{name:"employment_type",label:"Employment Type",align:"left",field:"employment_type",sortable:!1},{name:"designation",label:"Designation",align:"left",field:"designation",sortable:!1},{name:"post_assigned",label:"Post/Work Assigned",align:"left",field:"post_assigned",sortable:!1},{name:"name_of_workplace",label:"Workplace",align:"left",field:"name_of_workplace",sortable:!1},{name:"office",label:"Office",align:"left",field:"office",sortable:!0},{name:"actions",label:"Actions",align:"center"}],R=[{title:"Total",value:u.totalEmployees,icon:"person_search",iconColor:"light-blue-5",bgColor:"#d6f3ff"},{title:"Work Charge",value:u.wcCount,icon:"person",iconColor:"red-6",bgColor:"#ffe1e1"},{title:"Provisional",value:u.peCount,icon:"person_add",iconColor:"orange-5",bgColor:"#ffe9d6"},{title:"Muster Roll",value:u.mrCount,icon:"how_to_reg",iconColor:"indigo-6",bgColor:"#d7d9ff"}],t=y({type:null,skill:null,search:null,designation:null,education_qln_pe:null,education_qln_mr:null}),M=[{label:"MR",value:"MR"},{label:"PE",value:"PE"},{label:"WC",value:"WC"}];y("");const w=ae(),S=y([]),h=y(!1),m=y({sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),c=()=>{Q({pagination:m.value,filter:t.value,search:t.value.search})};function Q(s){const{page:l,rowsPerPage:e,sortBy:k,descending:ke}=s.pagination,j=s.filter,A=s.search;h.value=!0,axios.get(route("employees.json-index-all",u.office),{params:{filter:j,page:l,rowsPerPage:e,search:A}}).then(f=>{console.log(f.data);const{list:C}=f.data,{data:_,per_page:T,current_page:N,total:z,to:Ce,from:_e}=C;S.value=_,m.value.page=N,m.value.rowsNumber=z,m.value.rowsPerPage=T}).catch(f=>{var C,_;w.notify({type:"negative",message:(_=(C=f==null?void 0:f.response)==null?void 0:C.data)==null?void 0:_.message})}).finally(()=>h.value=!1)}const W=()=>{w.loading.show(),axios.get(route("export.all",u.office),{responseType:"blob"}).then(s=>{const l=window.URL.createObjectURL(new Blob([s.data])),e=document.createElement("a");e.href=l,e.setAttribute("download",u.office.name.replace(/\s+/g,"_")+"_all_employees.xlsx"),e.click()}).catch(s=>{var l,e;w.notify({type:"negative",message:((e=(l=s.response)==null?void 0:l.data)==null?void 0:e.message)||"Failed to download file"})}).finally(()=>{w.loading.hide()})};L(()=>{Q({pagination:m.value,filter:t.value,search:t.value.search})});const D=()=>{window.history.back()};return(s,l)=>(i(),d(le,{class:"container",padding:""},{default:n(()=>[a("div",ne,[a("div",null,[a("div",ie,"All Employee List : "+p(r.office.name),1),o(F,{class:"text-dark"},{default:n(()=>[o(P,{class:"cursor-pointer",onClick:l[0]||(l[0]=e=>s.$inertia.get(s.route("dashboard"))),icon:"dashboard",label:"Dashboard"}),o(P,{class:"cursor-pointer",label:"Go Back",onClick:D})]),_:1})]),a("div",re,[o(v,{label:"WC Summary",color:"primary",onClick:l[1]||(l[1]=e=>s.$inertia.get(s.route("summary.wc")))}),o(v,{label:"PE Summary",color:"primary",onClick:l[2]||(l[2]=e=>s.$inertia.get(s.route("summary.pe")))}),o(v,{label:"MR Summary",color:"primary",onClick:l[3]||(l[3]=e=>s.$inertia.get(s.route("summary.mr")))})])]),l[14]||(l[14]=a("br",null,null,-1)),o(x,{flat:""},{default:n(()=>[o(V,null,{default:n(()=>[a("div",de,[a("div",ue,[(i(),I(O,null,G(R,e=>o(x,{flat:"",bordered:"",class:"col-12 col-sm bg-white q-px-md q-py-lg shadow-1",key:e.title},{default:n(()=>[a("div",me,[a("div",null,[a("div",ce,p(e.title),1),a("div",pe,p(e.value),1),l[12]||(l[12]=a("div",{class:"text-caption text-grey-6 q-mt-xs"}," Employees ",-1))]),o(B,{size:"48px",style:H({backgroundColor:e.bgColor}),"text-color":"white"},{default:n(()=>[o(q,{name:e.icon,color:e.iconColor,size:"20px"},null,8,["name","color"])]),_:2},1032,["style"])])]),_:2},1024)),64))]),o(x,{flat:"",bordered:"",class:"q-mt-md bg-white shadow-1"},{default:n(()=>[o(V,null,{default:n(()=>[l[13]||(l[13]=a("div",{class:"text-subtitle1 text-weight-medium text-grey-8 q-mb-md"}," Search Filter ",-1)),a("div",fe,[o(g,{label:"Select Employment Type",class:"col-12 col-sm-4",modelValue:t.value.type,"onUpdate:modelValue":[l[4]||(l[4]=e=>t.value.type=e),c],options:M,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue"]),t.value.type==="PE"?(i(),d(g,{key:0,label:"Select Designation",class:"col-12 col-sm-4",modelValue:t.value.designation,"onUpdate:modelValue":[l[5]||(l[5]=e=>t.value.designation=e),c],options:r.designationsPe,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])):b("",!0),t.value.type==="WC"?(i(),d(g,{key:1,label:"Select Designation",class:"col-12 col-sm-4",modelValue:t.value.designation,"onUpdate:modelValue":[l[6]||(l[6]=e=>t.value.designation=e),c],options:r.designationsWc,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])):b("",!0),t.value.type==="MR"?(i(),d(g,{key:2,label:"Select Skill",class:"col-12 col-sm-4",modelValue:t.value.skill,"onUpdate:modelValue":[l[7]||(l[7]=e=>t.value.skill=e),c],options:r.skills,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])):b("",!0),t.value.type==="MR"?(i(),d(g,{key:3,label:"Select Education Qln.",class:"col-12 col-sm-4",modelValue:t.value.education_qln_mr,"onUpdate:modelValue":[l[8]||(l[8]=e=>t.value.education_qln_mr=e),c],options:r.educationQlnMr,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])):b("",!0),t.value.type==="PE"?(i(),d(g,{key:4,label:"Select Education Qln.",class:"col-12 col-sm-4",modelValue:t.value.education_qln_pe,"onUpdate:modelValue":[l[9]||(l[9]=e=>t.value.education_qln_pe=e),c],options:r.educationQlnPe,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])):b("",!0)])]),_:1,__:[13]}),o(J),o(V,{class:"row items-center justify-between q-gutter-md"},{default:n(()=>[a("div",ge,[o(v,{label:"Export",icon:"desktop_windows",color:"primary",onClick:W}),o(K,{dense:"",outlined:"",debounce:"300",modelValue:t.value.search,"onUpdate:modelValue":[l[10]||(l[10]=e=>t.value.search=e),c],placeholder:"Search",class:"col-12 col-sm-auto",clearable:""},{append:n(()=>[o(q,{name:"search"})]),_:1},8,["modelValue"])])]),_:1})]),_:1})])]),_:1}),o(oe,{flat:"",ref:"tableRef",title:r.office.name,rows:S.value,columns:$,"row-key":"id",pagination:m.value,"onUpdate:pagination":l[11]||(l[11]=e=>m.value=e),loading:h.value,filter:t.value,"binary-state-sort":"","rows-per-page-options":[1,7,15,30,50],onRequest:Q},{"body-cell-employee":n(e=>[o(E,{props:e},{default:n(()=>[a("div",ye,[o(B,null,{default:n(()=>[e.row.avatar?(i(),d(ee,{key:0,src:`/storage/${e.row.avatar}`},null,8,["src"])):(i(),d(q,{key:1,name:"person",size:"md",color:"primary"}))]),_:2},1024),a("div",null,[a("div",ve,p(e.row.name),1),a("div",be,p(e.row.mobile),1),a("div",we,p(Y(U)(e.row.date_of_birth)),1)])])]),_:2},1032,["props"])]),"body-cell-office":n(e=>[o(E,{props:e},{default:n(()=>[o(Z,{color:"primary","text-color":"white",dense:""},{default:n(()=>{var k;return[X(p((k=e.row.office)==null?void 0:k.name),1)]}),_:2},1024)]),_:2},1032,["props"])]),"body-cell-actions":n(e=>[o(E,{props:e},{default:n(()=>[o(v,{dense:"",flat:"",round:"",color:"primary",icon:"visibility",onClick:k=>s.$inertia.get(s.route("employee.show",e.row.id)),"aria-label":"Show user"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["title","rows","pagination","loading","filter"])]),_:1})]),_:1,__:[14]}))}});export{je as default};
