import{Q as L,a as E}from"./QBreadcrumbs-DuPJ5Puu.js";import{Q as B,a as F}from"./QSelect-DUW2EXsF.js";import{r as p,l as I,d as x,o as f,w as t,e as n,i as a,y as D,z as Q,q as v,f as V,h as w,t as c,A as M,D as q,Q as z}from"./app-CsRAFpWa.js";import{a as Y,Q as G}from"./QLayout-_rpFqsX-.js";import{Q as u}from"./QTd-D5MW47J6.js";import{Q as H}from"./QTable-CN53f-to.js";import{_ as J}from"./BackendLayout-CcMM9F0S.js";import{u as K}from"./use-quasar-Ci16OoEW.js";import"./format-D7gfa-4l.js";/* empty css            */import"./QMarkupTable-CXLUQUn0.js";import"./use-fullscreen-C4Sgyypj.js";import"./touch-BJ12Mx6Y.js";import"./QSlideTransition-D03lLUsK.js";const W={class:"flex items-center justify-between q-pa-md bg-white"},X={class:"q-pa-md"},Z={class:"row q-col-gutter-md"},ee={class:"row q-gutter-sm col-12 col-sm justify-end"},ae={class:"flex items-center gap-3"},te={class:"text-body1"},oe={class:"text-caption text-grey"},le={class:"text-caption text-grey"},se={key:0},ne={key:1},Qe=Object.assign({layout:J},{__name:"DeletedEmployees",props:["office","canCreate","canEdit","canDelete"],setup(R){const S=[{name:"employee",label:"Employee",align:"left",field:"employee",sortable:!0},{name:"type",label:"Employment Type",align:"left",field:"type",sortable:!0},{name:"designation",label:"Designation",align:"left",field:"designation",sortable:!0},{name:"office",label:"Office",align:"left",field:"office",sortable:!0},{name:"reason",label:"Reason",align:"left",field:"reason",sortable:!1},{name:"year",label:"Year",align:"left",field:"year",sortable:!1},{name:"supporting_document",label:"Document",align:"center",field:"supporting_document",sortable:!1},{name:"actions",label:"Actions",align:"center"}],i=p({office:null,reason:null}),h=p(""),d=K(),C=p([]),_=p(!1),r=p({sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),k=()=>{i.value.search=h.value,g({pagination:r.value,filter:i.value,search:i.value.search})};function g(l){const{page:o,rowsPerPage:e,sortBy:s,descending:ie}=l.pagination,U=l.filter,j=l.search;_.value=!0,axios.get(route("employees.json-index-deleted"),{params:{filter:U,page:o,rowsPerPage:e,search:j}}).then(m=>{console.log(m.data);const{list:y}=m.data,{data:b,per_page:A,current_page:N,total:T,to:re,from:de}=y;C.value=b,r.value.page=N,r.value.rowsNumber=T,r.value.rowsPerPage=A}).catch(m=>{var y,b;d.notify({type:"negative",message:(b=(y=m==null?void 0:m.response)==null?void 0:y.data)==null?void 0:b.message})}).finally(()=>_.value=!1)}I(()=>{g({pagination:r.value,filter:i.value,search:i.value.search})});const $=l=>{d.dialog({title:"Confirm",message:`Are you sure you want to move <b>${l.name}</b> to trash?`,html:!0,cancel:!0,persistent:!0,ok:{label:"Yes, Move to Trash",color:"negative"}}).onOk(async()=>{try{await axios.delete(route("employee.destroy",l)),d.notify({type:"positive",message:`Employee ${l.name} moved to trash`}),g({pagination:r.value,filter:i.value,search:i.value.search})}catch{d.notify({type:"negative",message:"Failed to move employee to trash. Please try again."})}})},P=()=>{window.history.back()},O=()=>{d.loading.show(),axios.get(route("export.deleted"),{responseType:"blob"}).then(l=>{const o=window.URL.createObjectURL(new Blob([l.data])),e=document.createElement("a");e.href=o,e.setAttribute("download",Date.now()+".xlsx"),e.click()}).catch(l=>{var o,e;d.notify({type:"negative",message:((e=(o=l.response)==null?void 0:o.data)==null?void 0:e.message)||"Failed to download file"})}).finally(()=>{d.loading.hide()})};return(l,o)=>(f(),x(G,{class:"container",padding:""},{default:t(()=>[n("div",W,[n("div",null,[o[5]||(o[5]=n("div",{class:"stitle"},"Deleted Employee List",-1)),a(L,{class:"text-dark"},{default:t(()=>[a(E,{class:"cursor-pointer",onClick:o[0]||(o[0]=e=>l.$inertia.get(l.route("dashboard"))),icon:"dashboard",label:"Dashboard"}),a(E,{class:"cursor-pointer",label:"Go Back",onClick:P})]),_:1})])]),o[7]||(o[7]=n("br",null,null,-1)),a(D,{flat:""},{default:t(()=>[a(Q,null,{default:t(()=>[n("div",X,[a(D,{flat:"",bordered:"",class:"q-mt-md bg-white shadow-1"},{default:t(()=>[a(Q,null,{default:t(()=>[o[6]||(o[6]=n("div",{class:"text-subtitle1 text-weight-medium text-grey-8 q-mb-md"}," Search Filter ",-1)),n("div",Z,[a(B,{label:"Select Office",class:"col-12 col-sm-4",modelValue:i.value.office,"onUpdate:modelValue":[o[1]||(o[1]=e=>i.value.office=e),k],options:R.office,"option-label":"name","option-value":"id","emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"]),a(B,{dense:"",outlined:"",debounce:"300",modelValue:i.value.reason,"onUpdate:modelValue":[o[2]||(o[2]=e=>i.value.reason=e),k],options:["Expired","Resigned","Dismissed","Regularised","Others","Overage (Retired)"],label:"Select Reason",class:"col-12 col-sm-4","emit-value":"","map-options":"",clearable:""},null,8,["modelValue"])])]),_:1,__:[6]})]),_:1})])]),_:1}),a(Q,{class:"row items-center justify-between q-gutter-md"},{default:t(()=>[n("div",ee,[a(v,{label:"Export",icon:"desktop_windows",color:"primary",onClick:O})])]),_:1}),a(H,{flat:"",ref:"tableRef",title:"List of Deleted Employees",rows:C.value,columns:S,"row-key":"id",pagination:r.value,"onUpdate:pagination":o[4]||(o[4]=e=>r.value=e),loading:_.value,filter:i.value,"binary-state-sort":"","rows-per-page-options":[1,7,15,30,50],onRequest:g},{"top-right":t(()=>[a(z,{dense:"",outlined:"",debounce:"800",modelValue:h.value,"onUpdate:modelValue":[o[3]||(o[3]=e=>h.value=e),k],placeholder:"Search",class:"col-12 col-sm-auto",clearable:""},{append:t(()=>[a(q,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-employee":t(e=>[a(u,{props:e},{default:t(()=>[n("div",ae,[a(M,null,{default:t(()=>[e.row.avatar?(f(),x(Y,{key:0,src:`/storage/${e.row.avatar}`},null,8,["src"])):(f(),x(q,{key:1,name:"person",size:"md",color:"primary"}))]),_:2},1024),n("div",null,[n("div",te,c(e.row.name),1),n("div",oe,c(e.row.mobile),1),n("div",le,c(e.row.date_of_birth),1)])])]),_:2},1032,["props"])]),"body-cell-type":t(e=>[a(u,{props:e},{default:t(()=>[w(c(e.row.designation&&e.row.designation!=="null"?"Provisional":"Muster Roll"),1)]),_:2},1032,["props"])]),"body-cell-office":t(e=>[a(u,{props:e},{default:t(()=>[a(F,{color:"primary","text-color":"white",dense:""},{default:t(()=>{var s;return[w(c((s=e.row.office)==null?void 0:s.name),1)]}),_:2},1024)]),_:2},1032,["props"])]),"body-cell-reason":t(e=>[a(u,{props:e},{default:t(()=>{var s;return[w(c((s=e.row.deletion_detail)==null?void 0:s.reason),1)]}),_:2},1032,["props"])]),"body-cell-year":t(e=>[a(u,{props:e},{default:t(()=>{var s;return[w(c((s=e.row.deletion_detail)==null?void 0:s.year),1)]}),_:2},1032,["props"])]),"body-cell-supporting_document":t(e=>[a(u,{props:e},{default:t(()=>{var s;return[(s=e.row.deletion_detail)!=null&&s.supporting_document?(f(),V("span",se,[a(v,{dense:"",flat:"",round:"",color:"primary",icon:"attachment",href:`/storage/${e.row.deletion_detail.supporting_document}`,target:"_blank"},null,8,["href"])])):(f(),V("span",ne,"N/A"))]}),_:2},1032,["props"])]),"body-cell-actions":t(e=>[a(u,{props:e},{default:t(()=>[a(v,{dense:"",flat:"",round:"",color:"primary",icon:"visibility",onClick:s=>l.$inertia.get(l.route("employee.show",e.row.id)),"aria-label":"Show user"},null,8,["onClick"]),a(v,{dense:"",flat:"",round:"",color:"negative",icon:"delete",onClick:s=>$(e.row),"aria-label":"Show user"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","pagination","loading","filter"])]),_:1})]),_:1,__:[7]}))}});export{Qe as default};
