import{a as V,Q as C}from"./QSelect-FRSa1g63.js";import{Q as M,a as P}from"./QBreadcrumbs-BRajDz7o.js";import{r as c,l as T,d as y,o as m,w as o,e as s,i as l,h as Q,f as z,F as W,v as G,q as x,y as H,z as E,p as J,Q as K,D as U,t as p,u as $,A as O}from"./app-Dy0RLM-h.js";import{a as X,Q as Y}from"./QLayout-DPHDM4cz.js";import{Q as _}from"./QTd-WJEa1zmA.js";import{Q as Z}from"./QTable-Dw5AP95-.js";import{_ as ee}from"./BackendLayout-BFn3YI9N.js";import{u as ae}from"./use-quasar-CBxPYuZb.js";import{u as le}from"./useUtils-DkiCkNDN.js";import"./format-awdxQzeS.js";import"./QMarkupTable-CXtkyhaG.js";import"./use-fullscreen-D4_F-i0e.js";import"./touch-CYPyR8TH.js";import"./QSlideTransition-CxOIRpAO.js";import"./date-Cy3yfkoO.js";const te={class:"flex items-center justify-between q-pa-md bg-white"},oe={class:"stitle"},se={class:"q-gutter-sm"},ne={class:"row q-col-gutter-md"},re={class:"row q-gutter-sm col-12 col-sm justify-end"},ie={class:"flex items-center gap-3"},de={class:"text-body1"},ue={class:"text-caption text-grey"},ce={class:"text-caption text-grey"},Ce=Object.assign({layout:ee},{__name:"MrEmployees",props:["offices","skills","educationQln"],setup(f){const{formatDate:q}=le(),S=f,R=[{name:"employee",label:"Employee",align:"left",field:"employee",sortable:!0},{name:"post_assigned",label:"Post/Work Assigned",align:"left",field:"post_assigned",sortable:!1},{name:"name_of_workplace",label:"Workplace",align:"left",field:"name_of_workplace",sortable:!1},{name:"office",label:"Office",align:"left",field:"office",sortable:!1},{name:"skill_at_present",label:"Skill At Present",align:"left",field:"skill_at_present",sortable:!0},{name:"date_of_engagement",label:"Initial Engagement",align:"left",field:"date_of_engagement",sortable:!0},{name:"actions",label:"Actions",align:"center"}],n=c({office:[],search:null,skill:null,education_qln:null});c("");const g=ae(),B=c([]),w=c(!1),i=c({sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),k=()=>{h({pagination:i.value,filter:n.value,search:n.value.search})};function h(t){const{page:a,rowsPerPage:e,sortBy:r,descending:d}=t.pagination,D=t.filter,N=t.search;w.value=!0,axios.get(route("employees.json-manager-mr"),{params:{filter:D,page:a,rowsPerPage:e,search:N}}).then(u=>{console.log(u.data);const{list:b}=u.data,{data:v,per_page:F,current_page:I,total:L,to:me,from:pe}=b;B.value=v,i.value.page=I,i.value.rowsNumber=L,i.value.rowsPerPage=F}).catch(u=>{var b,v;g.notify({type:"negative",message:(v=(b=u==null?void 0:u.response)==null?void 0:b.data)==null?void 0:v.message})}).finally(()=>w.value=!1)}const j=()=>{var a;g.loading.show();const t=(a=S.offices)!=null&&a.length?S.offices[0]:null;axios.get(route("export.mr",t==null?void 0:t.value),{responseType:"blob"}).then(e=>{const r=window.URL.createObjectURL(new Blob([e.data])),d=document.createElement("a");d.href=r,d.setAttribute("download",((t==null?void 0:t.label)||"employees").replace(/\s+/g,"_")+"_mr_employees.xlsx"),d.click()}).catch(e=>{var r,d;g.notify({type:"negative",message:((d=(r=e.response)==null?void 0:r.data)==null?void 0:d.message)||"Failed to download file"})}).finally(()=>{g.loading.hide()})};T(()=>{h({pagination:i.value,filter:n.value,search:n.value.search})});const A=()=>{window.history.back()};return(t,a)=>(m(),y(Y,{class:"container",padding:""},{default:o(()=>[s("div",te,[s("div",null,[s("div",oe,[a[6]||(a[6]=Q("Muster Roll Employee List: ")),(m(!0),z(W,null,G(f.offices,e=>(m(),y(V,{square:"",key:e.value,label:e.label},null,8,["label"]))),128))]),l(M,{class:"text-dark"},{default:o(()=>[l(P,{class:"cursor-pointer",onClick:a[0]||(a[0]=e=>t.$inertia.get(t.route("dashboard"))),icon:"dashboard",label:"Dashboard"}),l(P,{class:"cursor-pointer",label:"Go Back",onClick:A})]),_:1})]),s("div",se,[l(x,{label:"MR Summary",color:"primary",onClick:a[1]||(a[1]=e=>t.$inertia.get(t.route("summary.mr")))})])]),a[8]||(a[8]=s("br",null,null,-1)),l(H,{flat:""},{default:o(()=>[l(E,null,{default:o(()=>[a[7]||(a[7]=s("div",{class:"text-subtitle1 text-weight-medium text-grey-8 q-mb-md"}," Search Filter ",-1)),s("div",ne,[l(C,{label:"Select Present Skill",class:"col-12 col-sm-4",modelValue:n.value.skill,"onUpdate:modelValue":[a[2]||(a[2]=e=>n.value.skill=e),k],options:f.skills,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"]),l(C,{label:"Select Education Qln.",class:"col-12 col-sm-4",modelValue:n.value.education_qln,"onUpdate:modelValue":[a[3]||(a[3]=e=>n.value.education_qln=e),k],options:f.educationQln,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])])]),_:1,__:[7]}),l(J),l(E,{class:"row items-center justify-between q-gutter-md"},{default:o(()=>[s("div",re,[l(x,{label:"Export",icon:"desktop_windows",color:"primary",onClick:j}),l(K,{dense:"",outlined:"",debounce:"300",modelValue:n.value.search,"onUpdate:modelValue":[a[4]||(a[4]=e=>n.value.search=e),k],placeholder:"Search",class:"col-12 col-sm-auto",clearable:""},{append:o(()=>[l(U,{name:"search"})]),_:1},8,["modelValue"])])]),_:1}),l(Z,{flat:"",ref:"tableRef",rows:B.value,columns:R,"row-key":"id",pagination:i.value,"onUpdate:pagination":a[5]||(a[5]=e=>i.value=e),loading:w.value,filter:n.value,"binary-state-sort":"","rows-per-page-options":[1,7,15,30,50],onRequest:h},{"body-cell-employee":o(e=>[l(_,{props:e},{default:o(()=>[s("div",ie,[l(O,null,{default:o(()=>[e.row.avatar?(m(),y(X,{key:0,src:`/storage/${e.row.avatar}`},null,8,["src"])):(m(),y(U,{key:1,name:"person",size:"md",color:"primary"}))]),_:2},1024),s("div",null,[s("div",de,p(e.row.name),1),s("div",ue,p(e.row.mobile),1),s("div",ce,p($(q)(e.row.date_of_birth)),1)])])]),_:2},1032,["props"])]),"body-cell-office":o(e=>[l(_,{props:e},{default:o(()=>[l(V,{color:"primary","text-color":"white",dense:""},{default:o(()=>{var r;return[Q(p((r=e.row.office)==null?void 0:r.name),1)]}),_:2},1024)]),_:2},1032,["props"])]),"body-cell-date_of_engagement":o(e=>[l(_,{props:e},{default:o(()=>[Q(p($(q)(e.row.date_of_engagement)),1)]),_:2},1032,["props"])]),"body-cell-actions":o(e=>[l(_,{props:e},{default:o(()=>[l(x,{dense:"",flat:"",round:"",color:"primary",icon:"visibility",onClick:r=>t.$inertia.get(t.route("employee.show",e.row.id)),"aria-label":"Show user"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","pagination","loading","filter"])]),_:1})]),_:1,__:[8]}))}});export{Ce as default};
