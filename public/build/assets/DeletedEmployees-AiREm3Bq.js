import{Q as N,a as V}from"./QBreadcrumbs-CNN97VEF.js";import{Q as q,a as T}from"./QSelect-DTkBNhuG.js";import{r as m,l as L,d as _,o as h,w as l,e as t,i as o,y as B,z as x,q as D,h as b,t as d,A as I,D as R,Q as z}from"./app-B3_kA3DU.js";import{a as F,Q as M}from"./QLayout-CjoRmTJb.js";import{Q as u}from"./QTd-rXDVKVud.js";import{Q as G}from"./QTable-Dlu-zh3T.js";import{_ as W}from"./BackendLayout-B1DN56kQ.js";import{u as Y}from"./use-quasar-DWF58T8G.js";import"./QMarkupTable-b45L7n9P.js";import"./use-fullscreen-Dif6khKC.js";import"./touch-BmO7lSjr.js";import"./QSlideTransition-B8wZYg_w.js";const H={class:"flex items-center justify-between q-pa-md bg-white"},J={class:"q-pa-md"},K={class:"row q-col-gutter-md"},X={class:"row q-gutter-sm col-12 col-sm justify-end"},Z={class:"flex items-center gap-3"},ee={class:"text-body1"},ae={class:"text-caption text-grey"},le={class:"text-caption text-grey"},ve=Object.assign({layout:W},{__name:"DeletedEmployees",props:["office","canCreate","canEdit","canDelete"],setup(C){const E=[{name:"employee",label:"Employee",align:"left",field:"employee",sortable:!0},{name:"type",label:"Employment Type",align:"left",field:"type",sortable:!0},{name:"designation",label:"Designation",align:"left",field:"designation",sortable:!0},{name:"post_assigned",label:"Post/Work Assigned",align:"left",field:"post_assigned",sortable:!0},{name:"office",label:"Office",align:"left",field:"office",sortable:!0},{name:"reason",label:"Reason",align:"left",field:"reason",sortable:!1},{name:"year",label:"Year",align:"left",field:"year",sortable:!1},{name:"actions",label:"Actions",align:"center"}],i=m({office:null,reason:null}),Q=m(""),f=Y(),k=m([]),y=m(!1),r=m({sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),v=()=>{w({pagination:r.value,filter:i.value,search:i.value.search})};function w(s){const{page:a,rowsPerPage:e,sortBy:n,descending:oe}=s.pagination,U=s.filter,j=s.search;y.value=!0,axios.get(route("employees.json-index-deleted"),{params:{filter:U,page:a,rowsPerPage:e,search:j}}).then(c=>{console.log(c.data);const{list:p}=c.data,{data:g,per_page:O,current_page:$,total:A,to:te,from:se}=p;k.value=g,r.value.page=$,r.value.rowsNumber=A,r.value.rowsPerPage=O}).catch(c=>{var p,g;f.notify({type:"negative",message:(g=(p=c==null?void 0:c.response)==null?void 0:p.data)==null?void 0:g.message})}).finally(()=>y.value=!1)}L(()=>{w({pagination:r.value,filter:i.value,search:i.value.search})});const P=()=>{window.history.back()},S=()=>{f.loading.show(),axios.get(route("export.deleted"),{responseType:"blob"}).then(s=>{const a=window.URL.createObjectURL(new Blob([s.data])),e=document.createElement("a");e.href=a,e.setAttribute("download",Date.now()+".xlsx"),e.click()}).catch(s=>{var a,e;f.notify({type:"negative",message:((e=(a=s.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to download file"})}).finally(()=>{f.loading.hide()})};return(s,a)=>(h(),_(M,{class:"container",padding:""},{default:l(()=>[t("div",H,[t("div",null,[a[5]||(a[5]=t("div",{class:"stitle"},"Deleted Employee List",-1)),o(N,{class:"text-dark"},{default:l(()=>[o(V,{class:"cursor-pointer",onClick:a[0]||(a[0]=e=>s.$inertia.get(s.route("dashboard"))),icon:"dashboard",label:"Dashboard"}),o(V,{class:"cursor-pointer",label:"Go Back",onClick:P})]),_:1})])]),a[7]||(a[7]=t("br",null,null,-1)),o(B,{flat:""},{default:l(()=>[o(x,null,{default:l(()=>[t("div",J,[o(B,{flat:"",bordered:"",class:"q-mt-md bg-white shadow-1"},{default:l(()=>[o(x,null,{default:l(()=>[a[6]||(a[6]=t("div",{class:"text-subtitle1 text-weight-medium text-grey-8 q-mb-md"}," Search Filter ",-1)),t("div",K,[o(q,{label:"Select Office",class:"col-12 col-sm-4",modelValue:i.value.office,"onUpdate:modelValue":[a[1]||(a[1]=e=>i.value.office=e),v],options:C.office,"option-label":"name","option-value":"id","emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"]),o(q,{dense:"",outlined:"",debounce:"300",modelValue:i.value.reason,"onUpdate:modelValue":[a[2]||(a[2]=e=>i.value.reason=e),v],options:["Expired","Resigned","Dismissed","Regularised","Others","Overage (Retired)"],label:"Select Reason",class:"col-12 col-sm-4","emit-value":"","map-options":"",clearable:""},null,8,["modelValue"])])]),_:1,__:[6]})]),_:1})])]),_:1}),o(x,{class:"row items-center justify-between q-gutter-md"},{default:l(()=>[t("div",X,[o(D,{label:"Export",icon:"desktop_windows",color:"primary",onClick:S})])]),_:1}),o(G,{flat:"",ref:"tableRef",title:"List of Deleted Employees",rows:k.value,columns:E,"row-key":"id",pagination:r.value,"onUpdate:pagination":a[4]||(a[4]=e=>r.value=e),loading:y.value,filter:i.value,"binary-state-sort":"","rows-per-page-options":[1,7,15,30,50],onRequest:w},{"top-right":l(()=>[o(z,{dense:"",outlined:"",debounce:"800",modelValue:Q.value,"onUpdate:modelValue":[a[3]||(a[3]=e=>Q.value=e),v],placeholder:"Search",class:"col-12 col-sm-auto",clearable:""},{append:l(()=>[o(R,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-employee":l(e=>[o(u,{props:e},{default:l(()=>[t("div",Z,[o(I,null,{default:l(()=>[e.row.avatar?(h(),_(F,{key:0,src:`/storage/${e.row.avatar}`},null,8,["src"])):(h(),_(R,{key:1,name:"person",size:"md",color:"primary"}))]),_:2},1024),t("div",null,[t("div",ee,d(e.row.name),1),t("div",ae,d(e.row.mobile),1),t("div",le,d(e.row.date_of_birth),1)])])]),_:2},1032,["props"])]),"body-cell-type":l(e=>[o(u,{props:e},{default:l(()=>[b(d(e.row.designation?"Provisional":"Muster Roll"),1)]),_:2},1032,["props"])]),"body-cell-office":l(e=>[o(u,{props:e},{default:l(()=>[o(T,{color:"primary","text-color":"white",dense:""},{default:l(()=>{var n;return[b(d((n=e.row.office)==null?void 0:n.name),1)]}),_:2},1024)]),_:2},1032,["props"])]),"body-cell-reason":l(e=>[o(u,{props:e},{default:l(()=>{var n;return[b(d((n=e.row.deletion_detail)==null?void 0:n.reason),1)]}),_:2},1032,["props"])]),"body-cell-year":l(e=>[o(u,{props:e},{default:l(()=>{var n;return[b(d((n=e.row.deletion_detail)==null?void 0:n.year),1)]}),_:2},1032,["props"])]),"body-cell-actions":l(e=>[o(u,{props:e},{default:l(()=>[o(D,{dense:"",flat:"",round:"",color:"primary",icon:"visibility",onClick:n=>s.$inertia.get(s.route("employee.show",e.row.id)),"aria-label":"Show user"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","pagination","loading","filter"])]),_:1})]),_:1,__:[7]}))}});export{ve as default};
