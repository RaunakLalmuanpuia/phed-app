import{Q as D,a as h}from"./QBreadcrumbs-DFjYHtbA.js";import{r as u,a as V,i as v,o as y,j as t,f as n,g as a,t as c,p as A,q as I,Q as R,z as Q,m as k,B as x,v as L}from"./app-txQQtYoi.js";import{a as T,Q as z}from"./QLayout-Gto9Yw3U.js";import{Q as U,a as p}from"./QTable-DSo54Ayr.js";import{_ as M}from"./BackendLayout-CZHkup1x.js";import{u as O}from"./use-quasar-BqgtL0ak.js";import"./use-fullscreen-D1Apn0JD.js";import"./QSelect-BMncfXiE.js";import"./touch-CfxVUBMr.js";const W={class:"flex items-center justify-between q-pa-md bg-white"},F={class:"stitle"},G={class:"row q-gutter-sm col-12 col-sm justify-end"},H={class:"flex items-center gap-3"},J={class:"text-body1"},K={class:"text-caption text-grey"},X={class:"text-caption text-grey"},ce=Object.assign({layout:M},{__name:"PeEmployees",props:["office","canCreate","canEdit","canDelete"],setup(g){const P=g,B=[{name:"employee",label:"Employee",align:"left",field:"employee",sortable:!0},{name:"designation",label:"Designation",align:"left",field:"designation",sortable:!1},{name:"name_of_workplace",label:"Workplace",align:"left",field:"name_of_workplace",sortable:!1},{name:"remuneration",label:"Remuneration",align:"left",field:"remuneration",sortable:!0},{name:"date_of_next_increment",label:"Next Increment",align:"left",field:"date_of_next_increment",sortable:!0},{name:"actions",label:"Actions",align:"center"}],s=u({office:null,skill:null,search:null});u("");const $=O(),w=u([]),_=u(!1),r=u({sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),C=()=>{b({pagination:r.value,filter:s.value,search:s.value.search})};function b(l){const{page:o,rowsPerPage:e,sortBy:i,descending:Y}=l.pagination,E=l.filter,q=l.search;_.value=!0,axios.get(route("employees.json-index-pe",P.office),{params:{filter:E,page:o,rowsPerPage:e,search:q}}).then(d=>{console.log(d.data);const{list:m}=d.data,{data:f,per_page:N,current_page:S,total:j,to:Z,from:ee}=m;w.value=f,r.value.page=S,r.value.rowsNumber=j,r.value.rowsPerPage=N}).catch(d=>{var m,f;$.notify({type:"negative",message:(f=(m=d==null?void 0:d.response)==null?void 0:m.data)==null?void 0:f.message})}).finally(()=>_.value=!1)}return V(()=>{b({pagination:r.value,filter:s.value,search:s.value.search})}),(l,o)=>(y(),v(z,{class:"container",padding:""},{default:t(()=>[n("div",W,[n("div",null,[n("div",F,"Provisional Employee List: "+c(g.office.name),1),a(D,{class:"text-dark"},{default:t(()=>[a(h,{onClick:o[0]||(o[0]=e=>l.$inertia.get(l.route("dashboard"))),icon:"dashboard",label:"Dashboard"}),a(h,{label:"All Employees",to:l.route("mis.import")},null,8,["to"])]),_:1})])]),o[4]||(o[4]=n("br",null,null,-1)),a(A,{flat:"",bordered:""},{default:t(()=>[a(I,{class:"row items-center justify-between q-gutter-md"},{default:t(()=>[n("div",G,[a(R,{dense:"",outlined:"",debounce:"300",modelValue:s.value.search,"onUpdate:modelValue":[o[1]||(o[1]=e=>s.value.search=e),C],placeholder:"Search",class:"col-12 col-sm-auto",clearable:""},{append:t(()=>[a(Q,{name:"search"})]),_:1},8,["modelValue"]),a(k,{label:"Add New PE Employee",icon:"add",color:"primary",onClick:o[2]||(o[2]=e=>l.$inertia.get(l.route("employee.create")))})])]),_:1}),a(U,{flat:"",ref:"tableRef",title:g.office.name,rows:w.value,columns:B,"row-key":"id",pagination:r.value,"onUpdate:pagination":o[3]||(o[3]=e=>r.value=e),loading:_.value,filter:s.value,"binary-state-sort":"","rows-per-page-options":[1,7,15,30,50],onRequest:b},{"body-cell-employee":t(e=>[a(p,{props:e},{default:t(()=>[n("div",H,[a(L,null,{default:t(()=>[e.row.avatar?(y(),v(T,{key:0,src:`/storage/${e.row.avatar}`},null,8,["src"])):(y(),v(Q,{key:1,name:"person",size:"md",color:"primary"}))]),_:2},1024),n("div",null,[n("div",J,c(e.row.name),1),n("div",K,c(e.row.mobile),1),n("div",X,c(e.row.date_of_birth),1)])])]),_:2},1032,["props"])]),"body-cell-remuneration":t(e=>[a(p,{props:e},{default:t(()=>{var i;return[x(c(((i=e.row.remuneration_detail)==null?void 0:i.round_total)!=null?`₹ ${e.row.remuneration_detail.round_total.toLocaleString()}`:"—"),1)]}),_:2},1032,["props"])]),"body-cell-date_of_next_increment":t(e=>[a(p,{props:e},{default:t(()=>{var i;return[x(c((i=e.row.remuneration_detail)!=null&&i.next_increment_date?new Date(e.row.remuneration_detail.next_increment_date).toLocaleDateString():"—"),1)]}),_:2},1032,["props"])]),"body-cell-actions":t(e=>[a(p,{props:e},{default:t(()=>[a(k,{dense:"",flat:"",round:"",color:"primary",icon:"visibility",onClick:i=>l.$inertia.get(l.route("employee.show",e.row.id)),"aria-label":"Show user"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["title","rows","pagination","loading","filter"])]),_:1})]),_:1,__:[4]}))}});export{ce as default};
