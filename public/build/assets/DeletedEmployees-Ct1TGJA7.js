import{Q as N,a as E}from"./QBreadcrumbs-DdOo6CLK.js";import{Q as V,a as L}from"./QSelect-D0Qv8W7a.js";import{r as f,l as F,d as _,o as k,w as o,e as s,i as t,y as q,z as x,q as Q,h as y,t as c,A as I,D as B,Q as M}from"./app-A8LIxqNa.js";import{a as z,Q as Y}from"./QLayout-CaFE7UKv.js";import{Q as m}from"./QTd-BjcIujRV.js";import{Q as G}from"./QTable-DNHmx_bI.js";import{_ as W}from"./BackendLayout-C8hpvExO.js";import{u as H}from"./use-quasar-6-qZKlA-.js";/* empty css            */import"./QMarkupTable-DVBZjG4_.js";import"./use-fullscreen-Cg5tFgEP.js";import"./touch-Dq1a77_W.js";import"./QSlideTransition-CriaNNfz.js";const J={class:"flex items-center justify-between q-pa-md bg-white"},K={class:"q-pa-md"},X={class:"row q-col-gutter-md"},Z={class:"row q-gutter-sm col-12 col-sm justify-end"},ee={class:"flex items-center gap-3"},ae={class:"text-body1"},te={class:"text-caption text-grey"},oe={class:"text-caption text-grey"},he=Object.assign({layout:W},{__name:"DeletedEmployees",props:["office","canCreate","canEdit","canDelete"],setup(D){const R=[{name:"employee",label:"Employee",align:"left",field:"employee",sortable:!0},{name:"type",label:"Employment Type",align:"left",field:"type",sortable:!0},{name:"designation",label:"Designation",align:"left",field:"designation",sortable:!0},{name:"post_assigned",label:"Post/Work Assigned",align:"left",field:"post_assigned",sortable:!0},{name:"office",label:"Office",align:"left",field:"office",sortable:!0},{name:"reason",label:"Reason",align:"left",field:"reason",sortable:!1},{name:"year",label:"Year",align:"left",field:"year",sortable:!1},{name:"actions",label:"Actions",align:"center"}],n=f({office:null,reason:null}),v=f(""),d=H(),C=f([]),w=f(!1),r=f({sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),h=()=>{n.value.search=v.value,p({pagination:r.value,filter:n.value,search:n.value.search})};function p(l){const{page:a,rowsPerPage:e,sortBy:i,descending:le}=l.pagination,O=l.filter,U=l.search;w.value=!0,axios.get(route("employees.json-index-deleted"),{params:{filter:O,page:a,rowsPerPage:e,search:U}}).then(u=>{console.log(u.data);const{list:g}=u.data,{data:b,per_page:j,current_page:A,total:T,to:se,from:ne}=g;C.value=b,r.value.page=A,r.value.rowsNumber=T,r.value.rowsPerPage=j}).catch(u=>{var g,b;d.notify({type:"negative",message:(b=(g=u==null?void 0:u.response)==null?void 0:g.data)==null?void 0:b.message})}).finally(()=>w.value=!1)}F(()=>{p({pagination:r.value,filter:n.value,search:n.value.search})});const P=l=>{d.dialog({title:"Confirm",message:`Are you sure you want to move <b>${l.name}</b> to trash?`,html:!0,cancel:!0,persistent:!0,ok:{label:"Yes, Move to Trash",color:"negative"}}).onOk(async()=>{try{await axios.delete(route("employee.destroy",l)),d.notify({type:"positive",message:`Employee ${l.name} moved to trash`}),p({pagination:r.value,filter:n.value,search:n.value.search})}catch{d.notify({type:"negative",message:"Failed to move employee to trash. Please try again."})}})},S=()=>{window.history.back()},$=()=>{d.loading.show(),axios.get(route("export.deleted"),{responseType:"blob"}).then(l=>{const a=window.URL.createObjectURL(new Blob([l.data])),e=document.createElement("a");e.href=a,e.setAttribute("download",Date.now()+".xlsx"),e.click()}).catch(l=>{var a,e;d.notify({type:"negative",message:((e=(a=l.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to download file"})}).finally(()=>{d.loading.hide()})};return(l,a)=>(k(),_(Y,{class:"container",padding:""},{default:o(()=>[s("div",J,[s("div",null,[a[5]||(a[5]=s("div",{class:"stitle"},"Deleted Employee List",-1)),t(N,{class:"text-dark"},{default:o(()=>[t(E,{class:"cursor-pointer",onClick:a[0]||(a[0]=e=>l.$inertia.get(l.route("dashboard"))),icon:"dashboard",label:"Dashboard"}),t(E,{class:"cursor-pointer",label:"Go Back",onClick:S})]),_:1})])]),a[7]||(a[7]=s("br",null,null,-1)),t(q,{flat:""},{default:o(()=>[t(x,null,{default:o(()=>[s("div",K,[t(q,{flat:"",bordered:"",class:"q-mt-md bg-white shadow-1"},{default:o(()=>[t(x,null,{default:o(()=>[a[6]||(a[6]=s("div",{class:"text-subtitle1 text-weight-medium text-grey-8 q-mb-md"}," Search Filter ",-1)),s("div",X,[t(V,{label:"Select Office",class:"col-12 col-sm-4",modelValue:n.value.office,"onUpdate:modelValue":[a[1]||(a[1]=e=>n.value.office=e),h],options:D.office,"option-label":"name","option-value":"id","emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"]),t(V,{dense:"",outlined:"",debounce:"300",modelValue:n.value.reason,"onUpdate:modelValue":[a[2]||(a[2]=e=>n.value.reason=e),h],options:["Expired","Resigned","Dismissed","Regularised","Others","Overage (Retired)"],label:"Select Reason",class:"col-12 col-sm-4","emit-value":"","map-options":"",clearable:""},null,8,["modelValue"])])]),_:1,__:[6]})]),_:1})])]),_:1}),t(x,{class:"row items-center justify-between q-gutter-md"},{default:o(()=>[s("div",Z,[t(Q,{label:"Export",icon:"desktop_windows",color:"primary",onClick:$})])]),_:1}),t(G,{flat:"",ref:"tableRef",title:"List of Deleted Employees",rows:C.value,columns:R,"row-key":"id",pagination:r.value,"onUpdate:pagination":a[4]||(a[4]=e=>r.value=e),loading:w.value,filter:n.value,"binary-state-sort":"","rows-per-page-options":[1,7,15,30,50],onRequest:p},{"top-right":o(()=>[t(M,{dense:"",outlined:"",debounce:"800",modelValue:v.value,"onUpdate:modelValue":[a[3]||(a[3]=e=>v.value=e),h],placeholder:"Search",class:"col-12 col-sm-auto",clearable:""},{append:o(()=>[t(B,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-employee":o(e=>[t(m,{props:e},{default:o(()=>[s("div",ee,[t(I,null,{default:o(()=>[e.row.avatar?(k(),_(z,{key:0,src:`/storage/${e.row.avatar}`},null,8,["src"])):(k(),_(B,{key:1,name:"person",size:"md",color:"primary"}))]),_:2},1024),s("div",null,[s("div",ae,c(e.row.name),1),s("div",te,c(e.row.mobile),1),s("div",oe,c(e.row.date_of_birth),1)])])]),_:2},1032,["props"])]),"body-cell-type":o(e=>[t(m,{props:e},{default:o(()=>[y(c(e.row.designation?"Provisional":"Muster Roll"),1)]),_:2},1032,["props"])]),"body-cell-office":o(e=>[t(m,{props:e},{default:o(()=>[t(L,{color:"primary","text-color":"white",dense:""},{default:o(()=>{var i;return[y(c((i=e.row.office)==null?void 0:i.name),1)]}),_:2},1024)]),_:2},1032,["props"])]),"body-cell-reason":o(e=>[t(m,{props:e},{default:o(()=>{var i;return[y(c((i=e.row.deletion_detail)==null?void 0:i.reason),1)]}),_:2},1032,["props"])]),"body-cell-year":o(e=>[t(m,{props:e},{default:o(()=>{var i;return[y(c((i=e.row.deletion_detail)==null?void 0:i.year),1)]}),_:2},1032,["props"])]),"body-cell-actions":o(e=>[t(m,{props:e},{default:o(()=>[t(Q,{dense:"",flat:"",round:"",color:"primary",icon:"visibility",onClick:i=>l.$inertia.get(l.route("employee.show",e.row.id)),"aria-label":"Show user"},null,8,["onClick"]),t(Q,{dense:"",flat:"",round:"",color:"negative",icon:"delete",onClick:i=>P(e.row),"aria-label":"Show user"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","pagination","loading","filter"])]),_:1})]),_:1,__:[7]}))}});export{he as default};
