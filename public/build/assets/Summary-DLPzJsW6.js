import{Q as B,a as y}from"./QBreadcrumbs-CNN97VEF.js";import{r as _,c as C,l as N,d as w,o as d,w as a,e as n,i as r,q as D,g as F,f as g,F as b,v as V,_ as q,h as s,t as l,Q as E,D as L}from"./app-B3_kA3DU.js";import{Q as u}from"./QTd-rXDVKVud.js";import{Q as R}from"./QTr-BwImnv2E.js";import{Q as T}from"./QTable-Dlu-zh3T.js";import{Q as $}from"./QLayout-CjoRmTJb.js";import{_ as j}from"./BackendLayout-B1DN56kQ.js";import{u as I}from"./use-quasar-DWF58T8G.js";import"./QMarkupTable-b45L7n9P.js";import"./QSelect-DTkBNhuG.js";import"./use-fullscreen-Dif6khKC.js";import"./touch-BmO7lSjr.js";import"./QSlideTransition-B8wZYg_w.js";const M={class:"flex items-center justify-between q-pa-md bg-white"},O={class:"q-gutter-sm"},oe=Object.assign({layout:j},{__name:"Summary",props:["office","canGenerateRemuneration"],setup(P){const c=I(),f=_([]),p=_({}),i=_(""),h=[{name:"office_name",label:"Name of Office",field:"office_name",align:"left"},{name:"employee_count",label:"No. of PE",field:"employee_count",align:"center"},{name:"one_month",label:"Wages for 1 Month (₹)",field:"one_month",align:"right"},{name:"three_months",label:"Wages for 3 Months (₹)",field:"three_months",align:"right"},{name:"six_months",label:"Wages for 6 Months (₹)",field:"six_months",align:"right"},{name:"one_year",label:"Wages for 1 Year (₹)",field:"one_year",align:"right"}],x=C(()=>i.value?f.value.filter(t=>t.office_name.toLowerCase().includes(i.value.toLowerCase())):f.value),m=t=>t==null?"":new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t);N(async()=>{const t=await axios.get(route("remuneration.json-summary"));f.value=t.data.data,p.value=t.data.totals});const v=()=>{c.loading.show(),axios.get(route("export.remuneration-summary"),{responseType:"blob"}).then(t=>{const o=window.URL.createObjectURL(new Blob([t.data])),e=document.createElement("a"),Q=new Date().getFullYear();e.href=o,e.setAttribute("download",`remuneration-summary-${Q}.xlsx`),e.click()}).catch(t=>{var o,e;c.notify({type:"negative",message:((e=(o=t.response)==null?void 0:o.data)==null?void 0:e.message)||"Failed to download file"})}).finally(()=>{c.loading.hide()})},k=()=>{window.history.back()};return(t,o)=>(d(),w($,{class:"container",padding:""},{default:a(()=>[n("div",M,[n("div",null,[o[3]||(o[3]=n("div",{class:"stitle"},"Remuneration Summary",-1)),r(B,{class:"text-dark"},{default:a(()=>[r(y,{onClick:o[0]||(o[0]=e=>t.$inertia.get(t.route("dashboard"))),icon:"dashboard",label:"Dashboard",class:"cursor-pointer"}),r(y,{class:"cursor-pointer",label:"Go Back",onClick:k})]),_:1})]),n("div",O,[r(D,{label:"Export",color:"primary",onClick:o[1]||(o[1]=e=>v()),icon:"download"})])]),o[4]||(o[4]=n("br",null,null,-1)),r(T,{rows:x.value,columns:h,"row-key":"office_name",flat:"",bordered:"",pagination:{rowsPerPage:0}},{"top-right":a(()=>[r(E,{borderless:"",dense:"",debounce:"800",modelValue:i.value,"onUpdate:modelValue":o[2]||(o[2]=e=>i.value=e),outlined:"",clearable:"",placeholder:"Search Office"},{append:a(()=>[r(L,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-one_month":a(e=>[r(u,{props:e},{default:a(()=>[s(l(m(e.row.one_month)),1)]),_:2},1032,["props"])]),"body-cell-three_months":a(e=>[r(u,{props:e},{default:a(()=>[s(l(m(e.row.three_months)),1)]),_:2},1032,["props"])]),"body-cell-six_months":a(e=>[r(u,{props:e},{default:a(()=>[s(l(m(e.row.six_months)),1)]),_:2},1032,["props"])]),"body-cell-one_year":a(e=>[r(u,{props:e},{default:a(()=>[s(l(m(e.row.one_year)),1)]),_:2},1032,["props"])]),"bottom-row":a(()=>[i.value?F("",!0):(d(),w(R,{key:0,class:"bg-grey-3 text-bold q-border-t"},{default:a(()=>[(d(),g(b,null,V(h,e=>r(u,{key:e.name,class:q(["text-"+(e.align||"left"),"q-pa-xs"])},{default:a(()=>[n("strong",null,[["one_month","three_months","six_months","one_year"].includes(e.field)?(d(),g(b,{key:0},[s(l(m(p.value[e.field])),1)],64)):(d(),g(b,{key:1},[s(l(p.value[e.field]),1)],64))])]),_:2},1032,["class"])),64))]),_:1}))]),_:1},8,["rows"])]),_:1,__:[4]}))}});export{oe as default};
