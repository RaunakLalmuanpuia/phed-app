import{Q as S}from"./QChip-CM8_4_HM.js";import{Q as W,a as D}from"./QBreadcrumbs-B2QfNl3X.js";import{r as m,l as I,d as w,o as p,w as o,e as s,i as t,h as _,f as z,F as G,v as J,q,y as M,z as E,p as H,Q as K,D as U,t as u,u as B,A as X}from"./app-BUqhnzPm.js";import{Q as $}from"./QSelect-CCVo7Y3Q.js";import{a as Y,Q as Z}from"./QLayout-CwzJPS3D.js";import{Q as f}from"./QTd-Cpho22aX.js";import{Q as O}from"./QTable-Dj5hSTBf.js";import{_ as ee}from"./BackendLayout-B4VKV5U2.js";import{u as ae}from"./use-quasar-Gqu1uUMC.js";import{u as te}from"./useUtils-ppGv4Db3.js";/* empty css            */import"./format-C4QW3o8r.js";import"./QMarkupTable-Cc6WqFhy.js";import"./use-fullscreen-Be-XHZoV.js";import"./touch-QnEEk1Q2.js";import"./QSlideTransition-C3WU2b4u.js";import"./date-Byi8jsRW.js";const oe={class:"flex items-center justify-between q-pa-md bg-white"},le={class:"stitle"},se={class:"q-gutter-sm"},ne={class:"row q-col-gutter-md"},ie={class:"row q-gutter-sm col-12 col-sm justify-end"},re={class:"flex items-center gap-3"},de={class:"text-body1"},ce={class:"text-caption text-grey"},ue={class:"text-caption text-grey"},Ee=Object.assign({layout:ee},{__name:"WcEmployees",props:["offices","designations","educationQln"],setup(g){const{formatDate:h}=te(),C=g,P=[{name:"employee",label:"Employee",align:"left",field:"employee",sortable:!0},{name:"designation",label:"Designation",align:"left",field:"designation",sortable:!1},{name:"date_of_engagement",label:"Date of Joining",align:"left",field:"date_of_engagement",sortable:!1},{name:"date_of_retirement",label:"Date of Retirement",align:"left",field:"date_of_retirement",sortable:!1},{name:"name_of_workplace",label:"Workplace",align:"left",field:"name_of_workplace",sortable:!1},{name:"actions",label:"Actions",align:"center"}],n=m({office:[],search:null,designation:null,education_qln:null});m("");const b=ae(),V=m([]),Q=m(!1),r=m({sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),k=()=>{x({pagination:r.value,filter:n.value,search:n.value.search})};function x(l){const{page:a,rowsPerPage:e,sortBy:i,descending:d}=l.pagination,N=l.filter,A=l.search;Q.value=!0,axios.get(route("employees.json-manager-wc"),{params:{filter:N,page:a,rowsPerPage:e,search:A}}).then(c=>{console.log(c.data);const{list:v}=c.data,{data:y,per_page:F,current_page:L,total:T,to:me,from:pe}=v;V.value=y,r.value.page=L,r.value.rowsNumber=T,r.value.rowsPerPage=F}).catch(c=>{var v,y;b.notify({type:"negative",message:(y=(v=c==null?void 0:c.response)==null?void 0:v.data)==null?void 0:y.message})}).finally(()=>Q.value=!1)}const j=()=>{var a;b.loading.show();const l=(a=C.offices)!=null&&a.length?C.offices[0]:null;axios.get(route("export.wc",l==null?void 0:l.value),{responseType:"blob"}).then(e=>{const i=window.URL.createObjectURL(new Blob([e.data])),d=document.createElement("a");d.href=i,d.setAttribute("download",((l==null?void 0:l.label)||"employees").replace(/\s+/g,"_")+"_wc_employees.xlsx"),d.click()}).catch(e=>{var i,d;b.notify({type:"negative",message:((d=(i=e.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to download file"})}).finally(()=>{b.loading.hide()})};I(()=>{x({pagination:r.value,filter:n.value,search:n.value.search})});const R=()=>{window.history.back()};return(l,a)=>(p(),w(Z,{class:"container",padding:""},{default:o(()=>[s("div",oe,[s("div",null,[s("div",le,[a[6]||(a[6]=_("Work Charge Employee List: ")),(p(!0),z(G,null,J(g.offices,e=>(p(),w(S,{square:"",key:e.value,label:e.label},null,8,["label"]))),128))]),t(W,{class:"text-dark"},{default:o(()=>[t(D,{class:"cursor-pointer",onClick:a[0]||(a[0]=e=>l.$inertia.get(l.route("dashboard"))),icon:"dashboard",label:"Dashboard"}),t(D,{class:"cursor-pointer",label:"Go Back",onClick:R})]),_:1})]),s("div",se,[t(q,{label:"WC Summary",color:"primary",onClick:a[1]||(a[1]=e=>l.$inertia.get(l.route("summary.wc")))})])]),a[8]||(a[8]=s("br",null,null,-1)),t(M,{flat:"",bordered:""},{default:o(()=>[t(E,null,{default:o(()=>[a[7]||(a[7]=s("div",{class:"text-subtitle1 text-weight-medium text-grey-8 q-mb-md"}," Search Filter ",-1)),s("div",ne,[t($,{label:"Select Designation",class:"col-12 col-sm-4",modelValue:n.value.designation,"onUpdate:modelValue":[a[2]||(a[2]=e=>n.value.designation=e),k],options:g.designations,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"]),t($,{label:"Select Education Qln.",class:"col-12 col-sm-4",modelValue:n.value.education_qln,"onUpdate:modelValue":[a[3]||(a[3]=e=>n.value.education_qln=e),k],options:g.educationQln,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])])]),_:1,__:[7]}),t(H),t(E,{class:"row items-center justify-between q-gutter-md"},{default:o(()=>[s("div",ie,[t(q,{label:"Export",icon:"desktop_windows",color:"primary",onClick:j}),t(K,{dense:"",outlined:"",debounce:"300",modelValue:n.value.search,"onUpdate:modelValue":[a[4]||(a[4]=e=>n.value.search=e),k],placeholder:"Search",class:"col-12 col-sm-auto",clearable:""},{append:o(()=>[t(U,{name:"search"})]),_:1},8,["modelValue"])])]),_:1}),t(O,{flat:"",ref:"tableRef",rows:V.value,columns:P,"row-key":"id",pagination:r.value,"onUpdate:pagination":a[5]||(a[5]=e=>r.value=e),loading:Q.value,filter:n.value,"binary-state-sort":"","rows-per-page-options":[1,7,15,30,50],onRequest:x},{"body-cell-employee":o(e=>[t(f,{props:e},{default:o(()=>[s("div",re,[t(X,null,{default:o(()=>[e.row.avatar?(p(),w(Y,{key:0,src:`/storage/${e.row.avatar}`},null,8,["src"])):(p(),w(U,{key:1,name:"person",size:"md",color:"primary"}))]),_:2},1024),s("div",null,[s("div",de,u(e.row.name),1),s("div",ce,u(e.row.mobile),1),s("div",ue,u(B(h)(e.row.date_of_birth)),1)])])]),_:2},1032,["props"])]),"body-cell-office":o(e=>[t(f,{props:e},{default:o(()=>[t(S,{color:"primary","text-color":"white",dense:""},{default:o(()=>{var i;return[_(u((i=e.row.office)==null?void 0:i.name),1)]}),_:2},1024)]),_:2},1032,["props"])]),"body-cell-date_of_engagement":o(e=>[t(f,{props:e},{default:o(()=>[_(u(B(h)(e.row.date_of_engagement)),1)]),_:2},1032,["props"])]),"body-cell-date_of_retirement":o(e=>[t(f,{props:e},{default:o(()=>[_(u(B(h)(e.row.date_of_retirement)),1)]),_:2},1032,["props"])]),"body-cell-actions":o(e=>[t(f,{props:e},{default:o(()=>[t(q,{dense:"",flat:"",round:"",color:"primary",icon:"visibility",onClick:i=>l.$inertia.get(l.route("employee.show",e.row.id)),"aria-label":"Show user"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","pagination","loading","filter"])]),_:1})]),_:1,__:[8]}))}});export{Ee as default};
