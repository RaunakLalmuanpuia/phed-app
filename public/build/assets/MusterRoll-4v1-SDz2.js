import{Q as I,a as x}from"./QBreadcrumbs-B1Dv6aS9.js";import{r as _,d as w,o as d,w as o,e as r,i as a,q as M,y as Q,z as v,f as S,F as B,v as T,u as C,t as u,Q as q,D as E}from"./app-j15XV9kI.js";import{Q as s}from"./QTd-DD5GpOFU.js";import{Q as N}from"./QTr-BfYqG2WM.js";import{Q as V}from"./QTable-rhNBwSjt.js";import{Q as P}from"./QLayout-OwaLqr18.js";import{_ as R}from"./BackendLayout-CcATLsQM.js";import{u as A}from"./use-quasar-DcrsI3lG.js";import"./format-KQXfQuLj.js";import"./QMarkupTable-D4PDCKEg.js";import"./QSelect-Cc-L-Qka.js";import"./QChip-D4pddzr-.js";import"./use-fullscreen-DAAQnoxB.js";import"./touch-CEXDvBRo.js";import"./QSlideTransition-BjsrowFb.js";const F={class:"flex items-center justify-between q-pa-md bg-white"},$={class:"q-gutter-sm"},ae=Object.assign({layout:R},{__name:"MusterRoll",props:{offices:Array,skills:Array,schemes:Array},setup(O){const n=O,m=A(),c=_(""),y=["Skilled-I","Skilled-II","Semi-Skilled","Unskilled"],f=[{name:"name",label:"Office Name",field:"name",align:"left",sortable:!0}],i=[...n.skills].sort((l,e)=>y.indexOf(l)-y.indexOf(e));i.forEach(l=>{f.push({name:l,label:l||"No Skill Mentioned",field:l,align:"center",sortable:!0})}),f.push({name:"total",label:"Total",field:"total",align:"center",sortable:!0});const h=l=>n.offices.reduce((e,t)=>{const g=Number(t[l])||0;return e+g},0),b=_(""),p=[{name:"name",label:"Scheme Name",field:"name",align:"left",sortable:!0}];i.forEach(l=>{p.push({name:l,label:l||"No Skill Mentioned",field:l,align:"center",sortable:!0})}),p.push({name:"total",label:"Total",field:"total",align:"center",sortable:!0});const k=l=>n.schemes.reduce((e,t)=>{const g=Number(t[l])||0;return e+g},0),U=()=>{m.loading.show(),axios.get(route("export.summary-mr"),{responseType:"blob"}).then(l=>{const e=window.URL.createObjectURL(new Blob([l.data])),t=document.createElement("a");t.href=e,t.setAttribute("download",Date.now()+".xlsx"),t.click()}).catch(l=>{var e,t;m.notify({type:"negative",message:((t=(e=l.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to download file"})}).finally(()=>{m.loading.hide()})},D=l=>{window.history.back()};return(l,e)=>(d(),w(P,{class:"container",padding:""},{default:o(()=>[r("div",F,[r("div",null,[e[4]||(e[4]=r("div",{class:"stitle"},"Muster Roll Employees Summary",-1)),a(I,{class:"text-dark"},{default:o(()=>[a(x,{class:"cursor-pointer",onClick:e[0]||(e[0]=t=>l.$inertia.get(l.route("dashboard"))),icon:"dashboard",label:"Dashboard"}),a(x,{class:"cursor-pointer",label:"Go Back",onClick:D})]),_:1})]),r("div",$,[a(M,{label:"Export",color:"primary",onClick:e[1]||(e[1]=t=>U()),icon:"download"})])]),e[8]||(e[8]=r("br",null,null,-1)),a(Q,{flat:""},{default:o(()=>[a(v,null,{default:o(()=>[a(V,{rows:n.offices,columns:f,"row-key":"id",flat:"",filter:c.value,pagination:{rowsPerPage:0}},{"top-right":o(()=>[a(q,{borderless:"",dense:"",debounce:"800",modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=t=>c.value=t),outlined:"",clearable:"",placeholder:"Search Office"},{append:o(()=>[a(E,{name:"search"})]),_:1},8,["modelValue"])]),"bottom-row":o(()=>[a(N,{class:"bg-grey-3 text-bold q-border-t"},{default:o(()=>[a(s,{class:"text-left font-bold"},{default:o(()=>e[5]||(e[5]=[r("strong",null,"Total",-1)])),_:1,__:[5]}),(d(!0),S(B,null,T(C(i),t=>(d(),w(s,{key:t,class:"text-center font-bold"},{default:o(()=>[r("strong",null,u(h(t)),1)]),_:2},1024))),128)),a(s,{class:"text-center font-bold"},{default:o(()=>[r("strong",null,u(h("total")),1)]),_:1})]),_:1})]),_:1},8,["rows","filter"])]),_:1})]),_:1}),a(Q,{flat:"",class:"q-mt-md"},{default:o(()=>[a(v,null,{default:o(()=>[e[7]||(e[7]=r("div",{class:"text-h6 q-mb-sm"},"Scheme-wise Muster Roll Employees Summary",-1)),a(V,{rows:n.schemes,columns:p,"row-key":"id",flat:"",filter:b.value,pagination:{rowsPerPage:0}},{"top-right":o(()=>[a(q,{borderless:"",dense:"",debounce:"800",modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=t=>b.value=t),outlined:"",clearable:"",placeholder:"Search Scheme"},{append:o(()=>[a(E,{name:"search"})]),_:1},8,["modelValue"])]),"bottom-row":o(()=>[a(N,{class:"bg-grey-3 text-bold q-border-t"},{default:o(()=>[a(s,{class:"text-left font-bold"},{default:o(()=>e[6]||(e[6]=[r("strong",null,"Total",-1)])),_:1,__:[6]}),(d(!0),S(B,null,T(C(i),t=>(d(),w(s,{key:t,class:"text-center font-bold"},{default:o(()=>[r("strong",null,u(k(t)),1)]),_:2},1024))),128)),a(s,{class:"text-center font-bold"},{default:o(()=>[r("strong",null,u(k("total")),1)]),_:1})]),_:1})]),_:1},8,["rows","filter"])]),_:1,__:[7]})]),_:1})]),_:1,__:[8]}))}});export{ae as default};
