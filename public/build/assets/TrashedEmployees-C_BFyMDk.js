import{Q as O,a as Q}from"./QBreadcrumbs-BRajDz7o.js";import{r as g,l as j,d as h,o as w,w as t,e as n,i as l,y as I,q as x,h as v,t as c,A as S,D as C,Q as Y}from"./app-Dy0RLM-h.js";import{a as F,Q as L}from"./QLayout-DPHDM4cz.js";import{Q as m}from"./QTd-WJEa1zmA.js";import{a as M}from"./QSelect-FRSa1g63.js";import{Q as U}from"./QTable-Dw5AP95-.js";import{_ as W}from"./BackendLayout-BFn3YI9N.js";import{u as z}from"./use-quasar-CBxPYuZb.js";import"./format-awdxQzeS.js";import"./QMarkupTable-CXtkyhaG.js";import"./use-fullscreen-D4_F-i0e.js";import"./touch-CYPyR8TH.js";import"./QSlideTransition-CxOIRpAO.js";const G={class:"flex items-center justify-between q-pa-md bg-white"},H={class:"flex items-center gap-3"},J={class:"text-body1"},K={class:"text-caption text-grey"},X={class:"text-caption text-grey"},ye=Object.assign({layout:W},{__name:"TrashedEmployees",props:["office","canCreate","canEdit","canDelete"],setup(Z){const E=[{name:"employee",label:"Employee",align:"left",field:"employee",sortable:!0},{name:"type",label:"Employment Type",align:"left",field:"type",sortable:!0},{name:"designation",label:"Designation",align:"left",field:"designation",sortable:!0},{name:"post_assigned",label:"Post/Work Assigned",align:"left",field:"post_assigned",sortable:!0},{name:"office",label:"Office",align:"left",field:"office",sortable:!0},{name:"reason",label:"Reason",align:"left",field:"reason",sortable:!1},{name:"year",label:"Year",align:"left",field:"year",sortable:!1},{name:"actions",label:"Actions",align:"center"}],i=g({office:null,reason:null}),p=g(""),d=z(),k=g([]),_=g(!1),r=g({sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),P=a=>a.designation&&a.date_of_retirement?"Work Charge":a.designation&&!a.date_of_retirement?"Provisional":"Muster Roll",B=()=>{i.value.search=p.value,f({pagination:r.value,filter:i.value,search:i.value.search})};function f(a){const{page:o,rowsPerPage:e,sortBy:s,descending:ee}=a.pagination,R=a.filter,A=a.search;_.value=!0,axios.get(route("employees.json-index-trashed"),{params:{filter:R,page:o,rowsPerPage:e,search:A}}).then(u=>{console.log(u.data);const{list:y}=u.data,{data:b,per_page:V,current_page:q,total:N,to:ae,from:te}=y;k.value=b,r.value.page=q,r.value.rowsNumber=N,r.value.rowsPerPage=V}).catch(u=>{var y,b;d.notify({type:"negative",message:(b=(y=u==null?void 0:u.response)==null?void 0:y.data)==null?void 0:b.message})}).finally(()=>_.value=!1)}j(()=>{f({pagination:r.value,filter:i.value,search:i.value.search})});const D=a=>{d.dialog({title:"Confirm Restore",message:`Are you sure you want to restore <b>${a.name}</b>?`,html:!0,cancel:!0,persistent:!0,ok:{label:"Yes, Restore",color:"positive"}}).onOk(async()=>{var o,e;try{await axios.put(route("employee.restore",a)),d.notify({type:"positive",message:`Employee ${a.name} restored successfully`}),f({pagination:r.value,filter:i.value,search:p.value})}catch(s){d.notify({type:"negative",message:((e=(o=s.response)==null?void 0:o.data)==null?void 0:e.message)||"Failed to restore employee"})}})},$=a=>{d.dialog({title:"Confirm Permanent Delete",message:`Are you sure you want to permanently delete <b>${a.name}</b>? This action cannot be undone.`,html:!0,cancel:!0,persistent:!0,ok:{label:"Yes, Delete Permanently",color:"negative"}}).onOk(async()=>{var o,e;try{await axios.delete(route("employees.forceDelete",a.id)),d.notify({type:"positive",message:`Employee ${a.name} permanently deleted`}),f({pagination:r.value,filter:i.value,search:p.value})}catch(s){d.notify({type:"negative",message:((e=(o=s.response)==null?void 0:o.data)==null?void 0:e.message)||"Failed to delete employee permanently"})}})},T=()=>{window.history.back()};return(a,o)=>(w(),h(L,{class:"container",padding:""},{default:t(()=>[n("div",G,[n("div",null,[o[3]||(o[3]=n("div",{class:"stitle"},"Trashed Employee List",-1)),l(O,{class:"text-dark"},{default:t(()=>[l(Q,{class:"cursor-pointer",onClick:o[0]||(o[0]=e=>a.$inertia.get(a.route("dashboard"))),icon:"dashboard",label:"Dashboard"}),l(Q,{class:"cursor-pointer",label:"Go Back",onClick:T})]),_:1})])]),o[4]||(o[4]=n("br",null,null,-1)),l(I,{flat:""},{default:t(()=>[l(U,{flat:"",ref:"tableRef",title:"List of Trashed Employees",rows:k.value,columns:E,"row-key":"id",pagination:r.value,"onUpdate:pagination":o[2]||(o[2]=e=>r.value=e),loading:_.value,filter:i.value,"binary-state-sort":"","rows-per-page-options":[1,7,15,30,50],onRequest:f},{"top-right":t(()=>[l(Y,{dense:"",outlined:"",debounce:"800",modelValue:p.value,"onUpdate:modelValue":[o[1]||(o[1]=e=>p.value=e),B],placeholder:"Search",class:"col-12 col-sm-auto",clearable:""},{append:t(()=>[l(C,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-employee":t(e=>[l(m,{props:e},{default:t(()=>[n("div",H,[l(S,null,{default:t(()=>[e.row.avatar?(w(),h(F,{key:0,src:`/storage/${e.row.avatar}`},null,8,["src"])):(w(),h(C,{key:1,name:"person",size:"md",color:"primary"}))]),_:2},1024),n("div",null,[n("div",J,c(e.row.name),1),n("div",K,c(e.row.mobile),1),n("div",X,c(e.row.date_of_birth),1)])])]),_:2},1032,["props"])]),"body-cell-type":t(e=>[l(m,{props:e},{default:t(()=>[v(c(P(e.row)),1)]),_:2},1032,["props"])]),"body-cell-office":t(e=>[l(m,{props:e},{default:t(()=>[l(M,{color:"primary","text-color":"white",dense:""},{default:t(()=>{var s;return[v(c((s=e.row.office)==null?void 0:s.name),1)]}),_:2},1024)]),_:2},1032,["props"])]),"body-cell-reason":t(e=>[l(m,{props:e},{default:t(()=>{var s;return[v(c((s=e.row.deletion_detail)==null?void 0:s.reason),1)]}),_:2},1032,["props"])]),"body-cell-year":t(e=>[l(m,{props:e},{default:t(()=>{var s;return[v(c((s=e.row.deletion_detail)==null?void 0:s.year),1)]}),_:2},1032,["props"])]),"body-cell-actions":t(e=>[l(m,{props:e},{default:t(()=>[l(x,{dense:"",flat:"",round:"",color:"green",icon:"restore",onClick:s=>D(e.row),"aria-label":"Restore Employee"},null,8,["onClick"]),l(x,{dense:"",flat:"",round:"",color:"red",icon:"delete_forever",onClick:s=>$(e.row),"aria-label":"Delete Permanently"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","pagination","loading","filter"])]),_:1})]),_:1,__:[4]}))}});export{ye as default};
