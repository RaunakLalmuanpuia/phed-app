import{a as B,Q as b}from"./QSelect-BemEfQiN.js";import{Q as K,a as R}from"./QBreadcrumbs-OIoRQndP.js";import{r as v,l as O,d as u,o as i,w as n,e as a,i as o,h as U,f as $,F as M,v as j,q as h,y as q,z as V,t as g,A as D,B as X,D as E,g as Q,p as Y,Q as Z,u as ee}from"./app-BkJ7JZO3.js";import{a as le,Q as oe}from"./QLayout-DEYIHiHq.js";import{Q as S}from"./QTd-BuiGpinD.js";import{Q as te}from"./QTable-0JidZKtO.js";import{_ as ae}from"./BackendLayout-D0flmuVt.js";import{u as se}from"./use-quasar-BAv4GtwJ.js";import{u as ne}from"./useUtils-CdYTZ36b.js";import"./use-fullscreen-BrsTnPwr.js";import"./touch-DTo9c-L_.js";import"./date-ZySdOLKT.js";const ie={class:"flex items-center justify-between q-pa-md bg-white"},re={class:"stitle"},ue={class:"q-gutter-sm"},de={class:"q-pa-md"},me={class:"q-gutter-md row q-col-gutter-md"},ce={class:"row justify-between items-center"},pe={class:"text-grey-6 text-subtitle1"},fe={class:"text-h5 text-weight-bold"},ge={class:"row q-col-gutter-md"},ye={class:"row q-gutter-sm col-12 col-sm justify-end"},be={class:"flex items-center gap-3"},ve={class:"text-body1"},we={class:"text-caption text-grey"},_e={class:"text-caption text-grey"},Me=Object.assign({layout:ae},{__name:"AllEmployees",props:["offices","totalEmployees","peCount","mrCount","designations","educationQlnPe","educationQlnMr","skills"],setup(c){const{formatDate:T}=ne(),p=c;console.log(p.offices);const A=[{name:"employee",label:"Employee",align:"left",field:"employee",sortable:!0},{name:"employment_type",label:"Employment Type",align:"left",field:"employment_type",sortable:!1},{name:"designation",label:"Designation",align:"left",field:"designation",sortable:!1},{name:"name_of_workplace",label:"Workplace",align:"left",field:"name_of_workplace",sortable:!1},{name:"office",label:"Office",align:"left",field:"office",sortable:!0},{name:"actions",label:"Actions",align:"center"}],N=[{title:"Total",value:p.totalEmployees,icon:"person_search",iconColor:"light-blue-5",bgColor:"#d6f3ff"},{title:"Muster Roll",value:p.mrCount,icon:"how_to_reg",iconColor:"indigo-6",bgColor:"#d7d9ff"},{title:"Provisional",value:p.peCount,icon:"person_add",iconColor:"orange-5",bgColor:"#ffe9d6"}],t=v({office:[],type:null,skill:null,search:null,designation:null,education_qln_pe:null,education_qln_mr:null}),z=[{label:"MR",value:"MR"},{label:"PE",value:"PE"}];v("");const w=se(),P=v([]),x=v(!1),d=v({sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),f=()=>{C({pagination:d.value,filter:t.value,search:t.value.search})};function C(s){const{page:l,rowsPerPage:e,sortBy:r,descending:m}=s.pagination,I=s.filter,G=s.search;x.value=!0,axios.get(route("employees.json-manager-all"),{params:{filter:I,page:l,rowsPerPage:e,search:G}}).then(y=>{const{list:_}=y.data,{data:k,per_page:W,current_page:H,total:J,to:ke,from:he}=_;P.value=k,d.value.page=H,d.value.rowsNumber=J,d.value.rowsPerPage=W}).catch(y=>{var _,k;w.notify({type:"negative",message:(k=(_=y==null?void 0:y.response)==null?void 0:_.data)==null?void 0:k.message})}).finally(()=>x.value=!1)}const F=()=>{var l;w.loading.show();const s=(l=p.offices)!=null&&l.length?p.offices[0]:null;axios.get(route("export.all",s==null?void 0:s.value),{responseType:"blob"}).then(e=>{const r=window.URL.createObjectURL(new Blob([e.data])),m=document.createElement("a");m.href=r,m.setAttribute("download",((s==null?void 0:s.label)||"employees").replace(/\s+/g,"_")+"_all_employees.xlsx"),m.click()}).catch(e=>{var r,m;w.notify({type:"negative",message:((m=(r=e.response)==null?void 0:r.data)==null?void 0:m.message)||"Failed to download file"})}).finally(()=>{w.loading.hide()})};O(()=>{C({pagination:d.value,filter:t.value,search:t.value.search})});const L=()=>{window.history.back()};return(s,l)=>(i(),u(oe,{class:"container",padding:""},{default:n(()=>[a("div",ie,[a("div",null,[a("div",re,[l[10]||(l[10]=U("All Employee List : ")),(i(!0),$(M,null,j(c.offices,e=>(i(),u(B,{square:"",key:e.value,label:e.label},null,8,["label"]))),128))]),o(K,{class:"text-dark"},{default:n(()=>[o(R,{class:"cursor-pointer",onClick:l[0]||(l[0]=e=>s.$inertia.get(s.route("dashboard"))),icon:"dashboard",label:"Dashboard"}),o(R,{class:"cursor-pointer",label:"Go Back",onClick:L})]),_:1})]),a("div",ue,[o(h,{label:"PE Summary",color:"primary",onClick:l[1]||(l[1]=e=>s.$inertia.get(s.route("summary.pe")))}),o(h,{label:"MR Summary",color:"primary",onClick:l[2]||(l[2]=e=>s.$inertia.get(s.route("summary.mr")))})])]),l[13]||(l[13]=a("br",null,null,-1)),o(q,{flat:""},{default:n(()=>[o(V,null,{default:n(()=>[a("div",de,[a("div",me,[(i(),$(M,null,j(N,e=>o(q,{flat:"",bordered:"",class:"col-12 col-sm bg-white q-px-md q-py-lg shadow-1",key:e.title},{default:n(()=>[a("div",ce,[a("div",null,[a("div",pe,g(e.title),1),a("div",fe,g(e.value),1),l[11]||(l[11]=a("div",{class:"text-caption text-grey-6 q-mt-xs"}," Employees ",-1))]),o(D,{size:"48px",style:X({backgroundColor:e.bgColor}),"text-color":"white"},{default:n(()=>[o(E,{name:e.icon,color:e.iconColor,size:"20px"},null,8,["name","color"])]),_:2},1032,["style"])])]),_:2},1024)),64))]),o(q,{flat:"",bordered:"",class:"q-mt-md bg-white shadow-1"},{default:n(()=>[o(V,null,{default:n(()=>[l[12]||(l[12]=a("div",{class:"text-subtitle1 text-weight-medium text-grey-8 q-mb-md"}," Search Filter ",-1)),a("div",ge,[o(b,{label:"Select Employment Type",class:"col-12 col-sm-4",modelValue:t.value.type,"onUpdate:modelValue":[l[3]||(l[3]=e=>t.value.type=e),f],options:z,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue"]),t.value.type==="PE"?(i(),u(b,{key:0,label:"Select Designation",class:"col-12 col-sm-4",modelValue:t.value.designation,"onUpdate:modelValue":[l[4]||(l[4]=e=>t.value.designation=e),f],options:c.designations,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])):Q("",!0),t.value.type==="MR"?(i(),u(b,{key:1,label:"Select Skill",class:"col-12 col-sm-4",modelValue:t.value.skill,"onUpdate:modelValue":[l[5]||(l[5]=e=>t.value.skill=e),f],options:c.skills,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])):Q("",!0),t.value.type==="PE"?(i(),u(b,{key:2,label:"Select Education Qln.",class:"col-12 col-sm-4",modelValue:t.value.education_qln_pe,"onUpdate:modelValue":[l[6]||(l[6]=e=>t.value.education_qln_pe=e),f],options:c.educationQlnPe,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])):Q("",!0),t.value.type==="MR"?(i(),u(b,{key:3,label:"Select Education Qln.",class:"col-12 col-sm-4",modelValue:t.value.education_qln_mr,"onUpdate:modelValue":[l[7]||(l[7]=e=>t.value.education_qln_mr=e),f],options:c.educationQlnMr,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])):Q("",!0)])]),_:1,__:[12]}),o(Y),o(V,{class:"row items-center justify-between q-gutter-md"},{default:n(()=>[a("div",ye,[o(h,{label:"Export",icon:"desktop_windows",color:"primary",onClick:F}),o(Z,{dense:"",outlined:"",debounce:"300",modelValue:t.value.search,"onUpdate:modelValue":[l[8]||(l[8]=e=>t.value.search=e),f],placeholder:"Search",class:"col-12 col-sm-auto",clearable:""},{append:n(()=>[o(E,{name:"search"})]),_:1},8,["modelValue"])])]),_:1})]),_:1})])]),_:1}),o(te,{flat:"",ref:"tableRef",rows:P.value,columns:A,"row-key":"id",pagination:d.value,"onUpdate:pagination":l[9]||(l[9]=e=>d.value=e),loading:x.value,filter:t.value,"binary-state-sort":"","rows-per-page-options":[1,7,15,30,50],onRequest:C},{"body-cell-employee":n(e=>[o(S,{props:e},{default:n(()=>[a("div",be,[o(D,null,{default:n(()=>[e.row.avatar?(i(),u(le,{key:0,src:`/storage/${e.row.avatar}`},null,8,["src"])):(i(),u(E,{key:1,name:"person",size:"md",color:"primary"}))]),_:2},1024),a("div",null,[a("div",ve,g(e.row.name),1),a("div",we,g(e.row.mobile),1),a("div",_e,g(ee(T)(e.row.date_of_birth)),1)])])]),_:2},1032,["props"])]),"body-cell-office":n(e=>[o(S,{props:e},{default:n(()=>[o(B,{color:"primary","text-color":"white",dense:""},{default:n(()=>{var r;return[U(g((r=e.row.office)==null?void 0:r.name),1)]}),_:2},1024)]),_:2},1032,["props"])]),"body-cell-actions":n(e=>[o(S,{props:e},{default:n(()=>[o(h,{dense:"",flat:"",round:"",color:"primary",icon:"visibility",onClick:r=>s.$inertia.get(s.route("employee.show",e.row.id)),"aria-label":"Show user"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","pagination","loading","filter"])]),_:1})]),_:1,__:[13]}))}});export{Me as default};
