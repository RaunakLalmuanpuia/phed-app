import{Q as W,a as C}from"./QBreadcrumbs-C-hDNN1a.js";import{r as u,l as I,d as h,o as Q,w as o,e as s,i as t,t as d,q as k,y as L,z as V,p as z,Q as F,D as B,h as S,u as x,A as O}from"./app-Mk4LxwVf.js";import{Q as D}from"./QSelect-Jgfi_hTq.js";import{a as G,Q as J}from"./QLayout-DR3PFwUe.js";import{Q as g}from"./QTd-Bqwxujx5.js";import{Q as M}from"./QTable-DoQXCuvh.js";import{_ as H}from"./BackendLayout-BJDnntE4.js";import{u as K}from"./use-quasar-DgFoagEo.js";import{u as X}from"./useUtils-2dCIX7ET.js";import"./QChip-CxFvV2os.js";import"./format-CP-4e2en.js";import"./QMarkupTable-CxKserOA.js";import"./use-fullscreen-BK06AXrK.js";import"./touch-COCbICZ_.js";import"./QSlideTransition-BqA-xfKh.js";import"./date-CrE6vAQV.js";const Y={class:"flex items-center justify-between q-pa-md bg-white"},Z={class:"stitle"},ee={class:"q-gutter-sm"},ae={class:"row q-col-gutter-md"},te={class:"row q-gutter-sm col-12 col-sm justify-end"},oe={class:"flex items-center gap-3"},le={class:"text-body1"},se={class:"text-caption text-grey"},ne={class:"text-caption text-grey"},Ce=Object.assign({layout:H},{__name:"WcEmployees",props:["office","designations","educationQln","canCreate","canEdit","canDelete"],setup(c){const{formatDate:b}=X(),v=c,E=[{name:"employee",label:"Employee",align:"left",field:"employee",sortable:!0},{name:"designation",label:"Designation",align:"left",field:"designation",sortable:!1},{name:"date_of_engagement",label:"Date of Joining",align:"left",field:"date_of_engagement",sortable:!1},{name:"date_of_retirement",label:"Date of Retirement",align:"left",field:"date_of_retirement",sortable:!1},{name:"name_of_workplace",label:"Workplace",align:"left",field:"name_of_workplace",sortable:!1},{name:"actions",label:"Actions",align:"center"}],n=u({search:null,designation:null,education_qln:null});u("");const m=K(),q=u([]),w=u(!1),i=u({sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),y=()=>{_({pagination:i.value,filter:n.value,search:n.value.search})};function _(l){const{page:a,rowsPerPage:e,sortBy:P,descending:ie}=l.pagination,j=l.filter,R=l.search;w.value=!0,axios.get(route("employees.json-index-wc",v.office),{params:{filter:j,page:a,rowsPerPage:e,search:R}}).then(r=>{console.log(r.data);const{list:f}=r.data,{data:p,per_page:N,current_page:A,total:T,to:re,from:de}=f;q.value=p,i.value.page=A,i.value.rowsNumber=T,i.value.rowsPerPage=N}).catch(r=>{var f,p;m.notify({type:"negative",message:(p=(f=r==null?void 0:r.response)==null?void 0:f.data)==null?void 0:p.message})}).finally(()=>w.value=!1)}const U=()=>{m.loading.show(),axios.get(route("export.wc",v.office),{responseType:"blob"}).then(l=>{const a=window.URL.createObjectURL(new Blob([l.data])),e=document.createElement("a");e.href=a,e.setAttribute("download",v.office.name.replace(/\s+/g,"_")+"_workcharge_employees.xlsx"),e.click()}).catch(l=>{var a,e;m.notify({type:"negative",message:((e=(a=l.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to download file"})}).finally(()=>{m.loading.hide()})};I(()=>{_({pagination:i.value,filter:n.value,search:n.value.search})});const $=()=>{window.history.back()};return(l,a)=>(Q(),h(J,{class:"container",padding:""},{default:o(()=>[s("div",Y,[s("div",null,[s("div",Z,"Work Charge Employee List: "+d(c.office.name),1),t(W,{class:"text-dark"},{default:o(()=>[t(C,{class:"cursor-pointer",onClick:a[0]||(a[0]=e=>l.$inertia.get(l.route("dashboard"))),icon:"dashboard",label:"Dashboard"}),t(C,{class:"cursor-pointer",label:"Go Back",onClick:$})]),_:1})]),s("div",ee,[t(k,{label:"WC Summary",color:"primary",onClick:a[1]||(a[1]=e=>l.$inertia.get(l.route("summary.wc")))})])]),a[7]||(a[7]=s("br",null,null,-1)),t(L,{flat:"",bordered:""},{default:o(()=>[t(V,null,{default:o(()=>[a[6]||(a[6]=s("div",{class:"text-subtitle1 text-weight-medium text-grey-8 q-mb-md"}," Search Filter ",-1)),s("div",ae,[t(D,{label:"Select Designation",class:"col-12 col-sm-4",modelValue:n.value.designation,"onUpdate:modelValue":[a[2]||(a[2]=e=>n.value.designation=e),y],options:c.designations,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"]),t(D,{label:"Select Education Qln.",class:"col-12 col-sm-4",modelValue:n.value.education_qln,"onUpdate:modelValue":[a[3]||(a[3]=e=>n.value.education_qln=e),y],options:c.educationQln,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])])]),_:1,__:[6]}),t(z),t(V,{class:"row items-center justify-between q-gutter-md"},{default:o(()=>[s("div",te,[t(k,{label:"Export",icon:"desktop_windows",color:"primary",onClick:U}),t(F,{dense:"",outlined:"",debounce:"300",modelValue:n.value.search,"onUpdate:modelValue":[a[4]||(a[4]=e=>n.value.search=e),y],placeholder:"Search",class:"col-12 col-sm-auto",clearable:""},{append:o(()=>[t(B,{name:"search"})]),_:1},8,["modelValue"])])]),_:1}),t(M,{flat:"",ref:"tableRef",title:c.office.name,rows:q.value,columns:E,"row-key":"id",pagination:i.value,"onUpdate:pagination":a[5]||(a[5]=e=>i.value=e),loading:w.value,filter:n.value,"binary-state-sort":"","rows-per-page-options":[5,10,15,30,50],onRequest:_},{"body-cell-employee":o(e=>[t(g,{props:e},{default:o(()=>[s("div",oe,[t(O,null,{default:o(()=>[e.row.avatar?(Q(),h(G,{key:0,src:`/storage/${e.row.avatar}`},null,8,["src"])):(Q(),h(B,{key:1,name:"person",size:"md",color:"primary"}))]),_:2},1024),s("div",null,[s("div",le,d(e.row.name),1),s("div",se,d(e.row.mobile),1),s("div",ne,d(x(b)(e.row.date_of_birth)),1)])])]),_:2},1032,["props"])]),"body-cell-date_of_engagement":o(e=>[t(g,{props:e},{default:o(()=>[S(d(x(b)(e.row.date_of_engagement)),1)]),_:2},1032,["props"])]),"body-cell-date_of_retirement":o(e=>[t(g,{props:e},{default:o(()=>[S(d(x(b)(e.row.date_of_retirement)),1)]),_:2},1032,["props"])]),"body-cell-actions":o(e=>[t(g,{props:e},{default:o(()=>[t(k,{dense:"",flat:"",round:"",color:"primary",icon:"visibility",onClick:P=>l.$inertia.get(l.route("employee.show",e.row.id)),"aria-label":"Show user"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["title","rows","pagination","loading","filter"])]),_:1})]),_:1,__:[7]}))}});export{Ce as default};
