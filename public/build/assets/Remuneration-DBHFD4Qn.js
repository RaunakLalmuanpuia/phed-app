import{Q as K,a as j}from"./QBreadcrumbs-aSAOzy_J.js";import{Q as M}from"./QSelect-CQGWGemp.js";import{r as i,x as W,c as B,o as I,w as n,b as l,f as a,e as $,p as P,q as _,l as X,m as C,B as R,t as u,Q as O,z as Y,ac as Z,u as k,ab as ee,O as te}from"./app-B7sNyQqw.js";import{Q as y}from"./QTd-DXFM7PBn.js";import{Q as ae}from"./QTable-B6-lXVTl.js";import{Q as le}from"./QLayout-BlGSiR_e.js";import{_ as ne,C as oe}from"./BackendLayout-BSSZKIgr.js";import{u as se}from"./use-quasar-BidUX86I.js";import"./touch-v9go7inx.js";const ie={class:"flex items-center justify-between q-pa-md bg-white"},re={class:"q-pa-md"},ue={class:"row q-col-gutter-md"},de={class:"row q-gutter-sm col-12 col-sm justify-end"},me={class:"row q-mb-sm items-center"},ce={class:"col-8 text-body1"},fe={class:"row q-mb-sm items-center"},pe={class:"col-8 text-body1"},ve={class:"row q-mb-sm items-center"},be={class:"col-8 text-body1"},ge={class:"row q-mb-sm items-center"},_e={class:"col-8 text-body1"},ye={class:"row q-mb-sm items-center"},xe={class:"col-8 text-body1"},Se=Object.assign({layout:ne},{__name:"Remuneration",props:["office","canGenerateRemuneration"],setup(U){const b=i({offices:[]}),h=i(""),N=se(),x=i([]),S=i(!1),w=i(!1),D=i(!1),m=i(null);function G(){if(!b.value.offices||b.value.offices.length===0){N.notify({type:"negative",message:"Please select at least one office"});return}D.value=!0,x.value=[],setTimeout(()=>{m.value&&m.value.requestServerInteraction()})}function A(){p.value.page=1,m.value&&m.value.requestServerInteraction()}function E(){x.value=[],D.value=!1}function F(s){(!s||s.length===0)&&E()}const r=W({remuneration:"",next_increment_date:""}),p=i({sortBy:"next_increment_date",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),z=[{name:"name",label:"Name",field:"name",align:"left",sortable:!0},{name:"designation",label:"Designation",field:"designation",align:"left",sortable:!0},{name:"office",label:"Office",field:"office.name",align:"left"},{name:"remuneration",label:"Remuneration",field:"remuneration_detail.remuneration",align:"right"},{name:"total",label:"Total",field:"remuneration_detail.round_total",align:"right"},{name:"next_increment_date",label:"Next Increment",field:"remuneration_detail.next_increment_date",align:"left"},{name:"actions",label:"Actions",align:"center"}],T=i(null),v=i(null),L=s=>{v.value=s,s.remuneration_detail?(r.remuneration=s.remuneration_detail.remuneration,r.next_increment_date=s.remuneration_detail.next_increment_date):r.reset(),T.value=s.id,w.value=!0};function H(s){const{page:e,rowsPerPage:t,sortBy:o,descending:Q}=s.pagination;S.value=!0,axios.get(route("mis.json-remuneration"),{params:{filter:{...b.value},page:e,rowsPerPage:t,search:h.value,sortBy:o,descending:Q}}).then(d=>{const{list:c}=d.data,{data:f,per_page:q,current_page:V,total:g}=c;x.value=f,p.value.page=V,p.value.rowsNumber=g,p.value.rowsPerPage=q}).catch(d=>{var c,f;N.notify({type:"negative",message:(f=(c=d==null?void 0:d.response)==null?void 0:c.data)==null?void 0:f.message})}).finally(()=>S.value=!1)}const J=()=>{T.value&&r.put(route("remuneration.update",T.value),{onSuccess:()=>{w.value=!1,r.reset(),m.value&&m.value.requestServerInteraction(),N.notify({type:"positive",message:"Remuneration updated successfully."})}})};return(s,e)=>(I(),B(le,{class:"container",padding:""},{default:n(()=>[l("div",ie,[l("div",null,[e[7]||(e[7]=l("div",{class:"stitle"},"Remuneration List",-1)),a(K,{class:"text-dark"},{default:n(()=>[a(j,{onClick:e[0]||(e[0]=t=>s.$inertia.get(s.route("dashboard"))),icon:"dashboard",label:"Dashboard"}),a(j,{label:"Remuneration",to:s.route("mis.import")},null,8,["to"])]),_:1})])]),e[15]||(e[15]=l("br",null,null,-1)),a(P,{flat:""},{default:n(()=>[a(_,null,{default:n(()=>[l("div",re,[a(P,{flat:"",class:"q-mt-md bg-white shadow-1"},{default:n(()=>[a(_,null,{default:n(()=>[e[8]||(e[8]=l("div",{class:"text-subtitle1 text-weight-medium text-grey-8 q-mb-md"}," Office Filter ",-1)),l("div",ue,[a(M,{label:"Select Office(s)",class:"col-12 col-sm-6",modelValue:b.value.offices,"onUpdate:modelValue":[e[1]||(e[1]=t=>b.value.offices=t),F],options:U.office,"option-label":"name","option-value":"id","emit-value":"","map-options":"",outlined:"",dense:"",clearable:"",onClear:E},null,8,["modelValue","options"])])]),_:1,__:[8]}),a(X),a(_,{class:"row items-center justify-between q-gutter-md"},{default:n(()=>[l("div",de,[U.canGenerateRemuneration?(I(),B(C,{key:0,label:"Get Employee",color:"primary",onClick:G})):$("",!0)])]),_:1})]),_:1})])]),_:1})]),_:1}),e[16]||(e[16]=l("br",null,null,-1)),D.value?(I(),B(ae,{key:0,ref_key:"empTable",ref:m,title:"Employees",rows:x.value,columns:z,"row-key":"id",loading:S.value,pagination:p.value,"onUpdate:pagination":e[3]||(e[3]=t=>p.value=t),"rows-per-page-options":[5,10,20,50],onRequest:H},{"top-right":n(()=>[a(O,{borderless:"",dense:"",debounce:"800","bg-color":"grey-2",outlined:"",modelValue:h.value,"onUpdate:modelValue":[e[2]||(e[2]=t=>h.value=t),A],placeholder:"Search",clearable:""},{append:n(()=>[a(Y,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-office":n(t=>[a(y,{props:t},{default:n(()=>{var o;return[R(u((o=t.row.office)==null?void 0:o.name),1)]}),_:2},1032,["props"])]),"body-cell-remuneration":n(t=>[a(y,{props:t},{default:n(()=>{var o;return[R(u((o=t.row.remuneration_detail)==null?void 0:o.remuneration),1)]}),_:2},1032,["props"])]),"body-cell-total":n(t=>[a(y,{props:t},{default:n(()=>{var o;return[R(u((o=t.row.remuneration_detail)==null?void 0:o.round_total),1)]}),_:2},1032,["props"])]),"body-cell-next_increment_date":n(t=>[a(y,{props:t},{default:n(()=>{var o;return[R(u((o=t.row.remuneration_detail)==null?void 0:o.next_increment_date),1)]}),_:2},1032,["props"])]),"body-cell-actions":n(t=>[a(y,{props:t},{default:n(()=>[a(C,{dense:"",flat:"",round:"",color:"primary",icon:"edit",onClick:o=>L(t.row),"aria-label":"Edit"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","pagination"])):$("",!0),a(Z,{modelValue:w.value,"onUpdate:modelValue":e[6]||(e[6]=t=>w.value=t)},{default:n(()=>[a(P,{style:{"min-width":"400px"}},{default:n(()=>[a(_,null,{default:n(()=>e[9]||(e[9]=[l("div",{class:"text-h6"},"Edit Remuneration",-1)])),_:1,__:[9]}),a(_,{class:"q-gutter-md"},{default:n(()=>{var t,o,Q,d,c,f,q,V;return[l("div",me,[e[10]||(e[10]=l("div",{class:"col-4 text-subtitle2 text-grey-8"},"Name",-1)),l("div",ce,u((t=v.value)==null?void 0:t.name),1)]),l("div",fe,[e[11]||(e[11]=l("div",{class:"col-4 text-subtitle2 text-grey-8"},"Designation",-1)),l("div",pe,u((o=v.value)==null?void 0:o.designation),1)]),l("div",ve,[e[12]||(e[12]=l("div",{class:"col-4 text-subtitle2 text-grey-8"},"Office",-1)),l("div",be,u((d=(Q=v.value)==null?void 0:Q.office)==null?void 0:d.name),1)]),l("div",ge,[e[13]||(e[13]=l("div",{class:"col-4 text-subtitle2 text-grey-8"},"Current Remuneration (Total)",-1)),l("div",_e,"Rs "+u(((f=(c=v.value)==null?void 0:c.remuneration_detail)==null?void 0:f.total)||0),1)]),l("div",ye,[e[14]||(e[14]=l("div",{class:"col-4 text-subtitle2 text-grey-8"},"Date of Next Increment",-1)),l("div",xe,u(((V=(q=v.value)==null?void 0:q.remuneration_detail)==null?void 0:V.next_increment_date)||0),1)]),a(O,{label:"Remuneration",type:"number",modelValue:k(r).remuneration,"onUpdate:modelValue":e[4]||(e[4]=g=>k(r).remuneration=g),outlined:"",dense:""},null,8,["modelValue"]),a(O,{label:"Next Increment Date",type:"date",modelValue:k(r).next_increment_date,"onUpdate:modelValue":e[5]||(e[5]=g=>k(r).next_increment_date=g),outlined:"",dense:""},null,8,["modelValue"])]}),_:1}),a(ee,{align:"right"},{default:n(()=>[te(a(C,{flat:"",label:"Cancel"},null,512),[[oe]]),a(C,{color:"primary",label:"Update",onClick:J})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1,__:[15,16]}))}});export{Se as default};
