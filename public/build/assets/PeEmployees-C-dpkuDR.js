import{a as V,Q as C}from"./QSelect-BMAT1elC.js";import{Q as A,a as P}from"./QBreadcrumbs-BksNaD-_.js";import{r as m,i as z,c as y,o as f,w as l,b as s,f as t,B as w,d as G,F as M,n as W,m as x,p as H,q as E,l as J,Q as K,z as $,t as c,u as U,v as O}from"./app-B62Dg7JG.js";import{a as X,Q as Y}from"./QLayout-DrPVcH9M.js";import{Q as p}from"./QTd-jHKKfhyq.js";import{Q as Z}from"./QTable-Dh0Q5zNs.js";import{_ as ee}from"./BackendLayout-gbDVWIeG.js";import{u as ae}from"./use-quasar-BNLj87ae.js";import{u as te}from"./useUtils-NQGDHJt8.js";import"./use-fullscreen-Czx9hRXI.js";import"./touch-CXPsHAkq.js";import"./date-DlHkVWn6.js";const le={class:"flex items-center justify-between q-pa-md bg-white"},oe={class:"stitle"},ne={class:"q-gutter-sm"},se={class:"row q-col-gutter-md"},ie={class:"row q-gutter-sm col-12 col-sm justify-end"},re={class:"flex items-center gap-3"},de={class:"text-body1"},ue={class:"text-caption text-grey"},ce={class:"text-caption text-grey"},Be=Object.assign({layout:ee},{__name:"PeEmployees",props:["offices","designations","educationQln"],setup(g){const{formatDate:q}=te(),B=g,j=[{name:"employee",label:"Employee",align:"left",field:"employee",sortable:!0},{name:"designation",label:"Designation",align:"left",field:"designation",sortable:!1},{name:"name_of_workplace",label:"Workplace",align:"left",field:"name_of_workplace",sortable:!1},{name:"office",label:"Office",align:"left",field:"office",sortable:!1},{name:"remuneration",label:"Remuneration",align:"left",field:"remuneration",sortable:!0},{name:"date_of_next_increment",label:"Next Increment",align:"left",field:"date_of_next_increment",sortable:!0},{name:"actions",label:"Actions",align:"center"}],i=m({office:[],search:null,designation:null,education_qln:null});m("");const b=ae(),S=m([]),h=m(!1),r=m({sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),Q=()=>{k({pagination:r.value,filter:i.value,search:i.value.search})};function k(o){const{page:a,rowsPerPage:e,sortBy:n,descending:d}=o.pagination,R=o.filter,L=o.search;h.value=!0,axios.get(route("employees.json-manager-pe"),{params:{filter:R,page:a,rowsPerPage:e,search:L}}).then(u=>{console.log(u.data);const{list:v}=u.data,{data:_,per_page:F,current_page:I,total:T,to:me,from:fe}=v;S.value=_,r.value.page=I,r.value.rowsNumber=T,r.value.rowsPerPage=F}).catch(u=>{var v,_;b.notify({type:"negative",message:(_=(v=u==null?void 0:u.response)==null?void 0:v.data)==null?void 0:_.message})}).finally(()=>h.value=!1)}const D=()=>{var a;b.loading.show();const o=(a=B.offices)!=null&&a.length?B.offices[0]:null;axios.get(route("export.pe",o==null?void 0:o.value),{responseType:"blob"}).then(e=>{const n=window.URL.createObjectURL(new Blob([e.data])),d=document.createElement("a");d.href=n,d.setAttribute("download",((o==null?void 0:o.label)||"employees").replace(/\s+/g,"_")+"_pe_employees.xlsx"),d.click()}).catch(e=>{var n,d;b.notify({type:"negative",message:((d=(n=e.response)==null?void 0:n.data)==null?void 0:d.message)||"Failed to download file"})}).finally(()=>{b.loading.hide()})};z(()=>{k({pagination:r.value,filter:i.value,search:i.value.search})});const N=()=>{window.history.back()};return(o,a)=>(f(),y(Y,{class:"container",padding:""},{default:l(()=>[s("div",le,[s("div",null,[s("div",oe,[a[6]||(a[6]=w("Provisional Employee List: ")),(f(!0),G(M,null,W(g.offices,e=>(f(),y(V,{square:"",key:e.value,label:e.label},null,8,["label"]))),128))]),t(A,{class:"text-dark"},{default:l(()=>[t(P,{class:"cursor-pointer",onClick:a[0]||(a[0]=e=>o.$inertia.get(o.route("dashboard"))),icon:"dashboard",label:"Dashboard"}),t(P,{class:"cursor-pointer",label:"Go Back",onClick:N})]),_:1})]),s("div",ne,[t(x,{label:"PE Summary",color:"primary",onClick:a[1]||(a[1]=e=>o.$inertia.get(o.route("summary.pe")))})])]),a[8]||(a[8]=s("br",null,null,-1)),t(H,{flat:"",bordered:""},{default:l(()=>[t(E,null,{default:l(()=>[a[7]||(a[7]=s("div",{class:"text-subtitle1 text-weight-medium text-grey-8 q-mb-md"}," Search Filter ",-1)),s("div",se,[t(C,{label:"Select Designation",class:"col-12 col-sm-4",modelValue:i.value.designation,"onUpdate:modelValue":[a[2]||(a[2]=e=>i.value.designation=e),Q],options:g.designations,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"]),t(C,{label:"Select Education Qln.",class:"col-12 col-sm-4",modelValue:i.value.education_qln,"onUpdate:modelValue":[a[3]||(a[3]=e=>i.value.education_qln=e),Q],options:g.educationQln,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])])]),_:1,__:[7]}),t(J),t(E,{class:"row items-center justify-between q-gutter-md"},{default:l(()=>[s("div",ie,[t(x,{label:"Export",icon:"desktop_windows",color:"primary",onClick:D}),t(K,{dense:"",outlined:"",debounce:"300",modelValue:i.value.search,"onUpdate:modelValue":[a[4]||(a[4]=e=>i.value.search=e),Q],placeholder:"Search",class:"col-12 col-sm-auto",clearable:""},{append:l(()=>[t($,{name:"search"})]),_:1},8,["modelValue"])])]),_:1}),t(Z,{flat:"",ref:"tableRef",rows:S.value,columns:j,"row-key":"id",pagination:r.value,"onUpdate:pagination":a[5]||(a[5]=e=>r.value=e),loading:h.value,filter:i.value,"binary-state-sort":"","rows-per-page-options":[1,7,15,30,50],onRequest:k},{"body-cell-employee":l(e=>[t(p,{props:e},{default:l(()=>[s("div",re,[t(O,null,{default:l(()=>[e.row.avatar?(f(),y(X,{key:0,src:`/storage/${e.row.avatar}`},null,8,["src"])):(f(),y($,{key:1,name:"person",size:"md",color:"primary"}))]),_:2},1024),s("div",null,[s("div",de,c(e.row.name),1),s("div",ue,c(e.row.mobile),1),s("div",ce,c(U(q)(e.row.date_of_birth)),1)])])]),_:2},1032,["props"])]),"body-cell-remuneration":l(e=>[t(p,{props:e},{default:l(()=>{var n;return[w(c(((n=e.row.remuneration_detail)==null?void 0:n.round_total)!=null?`₹ ${e.row.remuneration_detail.round_total.toLocaleString()}`:"—"),1)]}),_:2},1032,["props"])]),"body-cell-office":l(e=>[t(p,{props:e},{default:l(()=>[t(V,{color:"primary","text-color":"white",dense:""},{default:l(()=>{var n;return[w(c((n=e.row.office)==null?void 0:n.name),1)]}),_:2},1024)]),_:2},1032,["props"])]),"body-cell-date_of_next_increment":l(e=>[t(p,{props:e},{default:l(()=>{var n;return[w(c((n=e.row.remuneration_detail)!=null&&n.next_increment_date?U(q)(e.row.remuneration_detail.next_increment_date):"—"),1)]}),_:2},1032,["props"])]),"body-cell-actions":l(e=>[t(p,{props:e},{default:l(()=>[t(x,{dense:"",flat:"",round:"",color:"primary",icon:"visibility",onClick:n=>o.$inertia.get(o.route("employee.show",e.row.id)),"aria-label":"Show user"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","pagination","loading","filter"])]),_:1})]),_:1,__:[8]}))}});export{Be as default};
