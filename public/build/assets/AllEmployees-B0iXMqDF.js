import{Q as A,a as F}from"./QBreadcrumbs-BqovQUvq.js";import{r as g,i as L,c as u,o as i,w as s,b as a,f as t,t as m,m as h,p as C,q,d as I,F as O,n as W,v as P,y as G,z as V,e as k,l as H,Q as J,B as K,u as X}from"./app-C2dex-nA.js";import{Q as y,a as Y}from"./QSelect-BZa9mMoO.js";import{a as Z,Q as ee}from"./QLayout-DfDNxEFp.js";import{Q as E}from"./QTd-BDG46jDw.js";import{Q as le}from"./QTable-CKa4PAwo.js";import{_ as te}from"./BackendLayout-61FwaHAo.js";import{u as oe}from"./use-quasar-25QNHLYa.js";import{u as ae}from"./useUtils-CCSkXXzh.js";import"./touch-C2QLkE3y.js";import"./date-BYqxjEjy.js";const se={class:"flex items-center justify-between q-pa-md bg-white"},ne={class:"stitle"},ie={class:"q-gutter-sm"},re={class:"q-pa-md"},de={class:"q-gutter-md row q-col-gutter-md"},ue={class:"row justify-between items-center"},me={class:"text-grey-6 text-subtitle1"},ce={class:"text-h5 text-weight-bold"},pe={class:"row q-col-gutter-md"},fe={class:"row q-gutter-sm col-12 col-sm justify-end"},ge={class:"flex items-center gap-3"},ye={class:"text-body1"},ve={class:"text-caption text-grey"},be={class:"text-caption text-grey"},Ue=Object.assign({layout:te},{__name:"AllEmployees",props:["office","totalEmployees","peCount","mrCount","deletedCount","designations","skills","educationQlnPe","educationQlnMr"],setup(r){const{formatDate:B}=ae(),c=r,R=[{name:"employee",label:"Employee",align:"left",field:"employee",sortable:!0},{name:"employment_type",label:"Employment Type",align:"left",field:"employment_type",sortable:!1},{name:"designation",label:"Designation",align:"left",field:"designation",sortable:!1},{name:"name_of_workplace",label:"Workplace",align:"left",field:"name_of_workplace",sortable:!1},{name:"office",label:"Office",align:"left",field:"office",sortable:!0},{name:"actions",label:"Actions",align:"center"}],U=[{title:"Total",value:c.totalEmployees,icon:"person_search",iconColor:"light-blue-5",bgColor:"#d6f3ff"},{title:"Muster Roll",value:c.mrCount,icon:"how_to_reg",iconColor:"indigo-6",bgColor:"#d7d9ff"},{title:"Provisional",value:c.peCount,icon:"person_add",iconColor:"orange-5",bgColor:"#ffe9d6"}],o=g({type:null,skill:null,search:null,designation:null,education_qln_pe:null,education_qln_mr:null}),$=[{label:"MR",value:"MR"},{label:"PE",value:"PE"}];g("");const v=oe(),S=g([]),Q=g(!1),d=g({sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),p=()=>{x({pagination:d.value,filter:o.value,search:o.value.search})};function x(n){const{page:l,rowsPerPage:e,sortBy:b,descending:we}=n.pagination,j=n.filter,T=n.search;Q.value=!0,axios.get(route("employees.json-index-all",c.office),{params:{filter:j,page:l,rowsPerPage:e,search:T}}).then(f=>{console.log(f.data);const{list:w}=f.data,{data:_,per_page:D,current_page:N,total:z,to:_e,from:he}=w;S.value=_,d.value.page=N,d.value.rowsNumber=z,d.value.rowsPerPage=D}).catch(f=>{var w,_;v.notify({type:"negative",message:(_=(w=f==null?void 0:f.response)==null?void 0:w.data)==null?void 0:_.message})}).finally(()=>Q.value=!1)}const M=()=>{v.loading.show(),axios.get(route("export.all",c.office),{responseType:"blob"}).then(n=>{const l=window.URL.createObjectURL(new Blob([n.data])),e=document.createElement("a");e.href=l,e.setAttribute("download",c.office.name.replace(/\s+/g,"_")+"_all_employees.xlsx"),e.click()}).catch(n=>{var l,e;v.notify({type:"negative",message:((e=(l=n.response)==null?void 0:l.data)==null?void 0:e.message)||"Failed to download file"})}).finally(()=>{v.loading.hide()})};return L(()=>{x({pagination:d.value,filter:o.value,search:o.value.search})}),(n,l)=>(i(),u(ee,{class:"container",padding:""},{default:s(()=>[a("div",se,[a("div",null,[a("div",ne,"All Employee List : "+m(r.office.name),1),t(A,{class:"text-dark"},{default:s(()=>[t(F,{onClick:l[0]||(l[0]=e=>n.$inertia.get(n.route("dashboard"))),icon:"dashboard",label:"Dashboard"})]),_:1})]),a("div",ie,[t(h,{label:"PE Summary",color:"primary",onClick:l[1]||(l[1]=e=>n.$inertia.get(n.route("summary.pe")))}),t(h,{label:"MR Summary",color:"primary",onClick:l[2]||(l[2]=e=>n.$inertia.get(n.route("summary.mr")))})])]),l[12]||(l[12]=a("br",null,null,-1)),t(C,{flat:""},{default:s(()=>[t(q,null,{default:s(()=>[a("div",re,[a("div",de,[(i(),I(O,null,W(U,e=>t(C,{flat:"",bordered:"",class:"col-12 col-sm bg-white q-px-md q-py-lg shadow-1",key:e.title},{default:s(()=>[a("div",ue,[a("div",null,[a("div",me,m(e.title),1),a("div",ce,m(e.value),1),l[10]||(l[10]=a("div",{class:"text-caption text-grey-6 q-mt-xs"}," Employees ",-1))]),t(P,{size:"48px",style:G({backgroundColor:e.bgColor}),"text-color":"white"},{default:s(()=>[t(V,{name:e.icon,color:e.iconColor,size:"20px"},null,8,["name","color"])]),_:2},1032,["style"])])]),_:2},1024)),64))]),t(C,{flat:"",bordered:"",class:"q-mt-md bg-white shadow-1"},{default:s(()=>[t(q,null,{default:s(()=>[l[11]||(l[11]=a("div",{class:"text-subtitle1 text-weight-medium text-grey-8 q-mb-md"}," Search Filter ",-1)),a("div",pe,[t(y,{label:"Select Employment Type",class:"col-12 col-sm-4",modelValue:o.value.type,"onUpdate:modelValue":[l[3]||(l[3]=e=>o.value.type=e),p],options:$,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue"]),o.value.type==="PE"?(i(),u(y,{key:0,label:"Select Designation",class:"col-12 col-sm-4",modelValue:o.value.designation,"onUpdate:modelValue":[l[4]||(l[4]=e=>o.value.designation=e),p],options:r.designations,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])):k("",!0),o.value.type==="MR"?(i(),u(y,{key:1,label:"Select Skill",class:"col-12 col-sm-4",modelValue:o.value.skill,"onUpdate:modelValue":[l[5]||(l[5]=e=>o.value.skill=e),p],options:r.skills,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])):k("",!0),o.value.type==="MR"?(i(),u(y,{key:2,label:"Select Education Qln.",class:"col-12 col-sm-4",modelValue:o.value.education_qln_mr,"onUpdate:modelValue":[l[6]||(l[6]=e=>o.value.education_qln_mr=e),p],options:r.educationQlnMr,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])):k("",!0),o.value.type==="PE"?(i(),u(y,{key:3,label:"Select Education Qln.",class:"col-12 col-sm-4",modelValue:o.value.education_qln_pe,"onUpdate:modelValue":[l[7]||(l[7]=e=>o.value.education_qln_pe=e),p],options:r.educationQlnPe,"emit-value":"","map-options":"",outlined:"",dense:"",clearable:""},null,8,["modelValue","options"])):k("",!0)])]),_:1,__:[11]}),t(H),t(q,{class:"row items-center justify-between q-gutter-md"},{default:s(()=>[a("div",fe,[t(J,{dense:"",outlined:"",debounce:"300",modelValue:o.value.search,"onUpdate:modelValue":[l[8]||(l[8]=e=>o.value.search=e),p],placeholder:"Search",class:"col-12 col-sm-auto",clearable:""},{append:s(()=>[t(V,{name:"search"})]),_:1},8,["modelValue"]),t(h,{label:"Export",icon:"desktop_windows",color:"primary",onClick:M})])]),_:1})]),_:1})])]),_:1}),t(le,{flat:"",ref:"tableRef",title:r.office.name,rows:S.value,columns:R,"row-key":"id",pagination:d.value,"onUpdate:pagination":l[9]||(l[9]=e=>d.value=e),loading:Q.value,filter:o.value,"binary-state-sort":"","rows-per-page-options":[1,7,15,30,50],onRequest:x},{"body-cell-employee":s(e=>[t(E,{props:e},{default:s(()=>[a("div",ge,[t(P,null,{default:s(()=>[e.row.avatar?(i(),u(Z,{key:0,src:`/storage/${e.row.avatar}`},null,8,["src"])):(i(),u(V,{key:1,name:"person",size:"md",color:"primary"}))]),_:2},1024),a("div",null,[a("div",ye,m(e.row.name),1),a("div",ve,m(e.row.mobile),1),a("div",be,m(X(B)(e.row.date_of_birth)),1)])])]),_:2},1032,["props"])]),"body-cell-office":s(e=>[t(E,{props:e},{default:s(()=>[t(Y,{color:"primary","text-color":"white",dense:""},{default:s(()=>{var b;return[K(m((b=e.row.office)==null?void 0:b.name),1)]}),_:2},1024)]),_:2},1032,["props"])]),"body-cell-actions":s(e=>[t(E,{props:e},{default:s(()=>[t(h,{dense:"",flat:"",round:"",color:"primary",icon:"visibility",onClick:b=>n.$inertia.get(n.route("employee.show",e.row.id)),"aria-label":"Show user"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["title","rows","pagination","loading","filter"])]),_:1})]),_:1,__:[12]}))}});export{Ue as default};
